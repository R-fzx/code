## 狄利克雷卷积与数论函数

$\color{red}\text{定义}$：数论函数：值域为整数的函数

$f(n),g(n)$ 的狄利克雷卷积记作 $(f*g)(n)$

$$
(f*g)(n)=\sum_{d|n}f(d)g(n/d)
$$

$I(n)=1$：恒等函数，完全积性函数

$e(n)=[n=1]$ ：元函数（$e*f=f$），完全积性函数 **！！！**

$id(n)=n$：单位函数，完全积性函数

$id^x(n)=n^x$：幂函数

$\color{red}\text{定义}$：完全积性函数：对于**任意**整数 $a,b$ 有 $f(ab)=f(a)f(b)$

$\varphi(n)=\sum_{i=1}^{n-1}[(i,n)=1]$：小于 $n$ 的整数中与 $n$ 互质的数的个数，称作欧拉函数，积性函数

$\mu(n)$：莫比乌斯函数，积性函数

$\color{red}\text{定义}$：积性函数：对于任意满足 $(a,b)=1$ 的整数 $a,b$ 有 $f(ab)=f(a)f(b)$

积性函数性质：

- $f(1)=1$

- $f(x)=\sum_{i}f(p_i^{k_i})$

- 若 $f(n),g(n)$ 是积性函数，则 $(f*g)(n)$ 也是积性函数

- 积性函数的逆是积性函数
  
  - $\color{red}\text{定义}$：若 $f*g=e$，则 $f$ 和 $g$ 互逆

## 莫比乌斯反演（噔 噔 咚

设数论函数 $F$ 和 $f$ 有如下关系：

$$
\begin{aligned}
F(n)
&= \sum_{d|n}f(d)\\
&= \sum_{d|n}(1*f(d))\\
&= I*f
\end{aligned}
$$

则 $f=I^{-1}*F$，其中 $I^{-1}$ 即为 $\mu$

由上述性质易知，$\mu$ 为积性函数

考虑其在质数的幂上的表现

假设我们要求 $\mu(p^k)$，其中 $p$ 是质数

分类讨论如下：

- $k=0$ 时：显然 $\mu(1)=1$

- $k=1$ 时：
  
  $$
  \sum_{d|p}I(d)\mu(p/d)=e(p)=0\\
由于\ p\ 为质数，所以\ I(1)\mu(p)+I(p)\mu(1)=0\\
则\ \mu(p)+1=0,\mu(p)=-1 
  $$

- $k>1$ 时：
  
  $$
  \sum_{d|p^k}I(d)\mu(p^k/d)=e(p^k)=0\\
I(p^k)\mu(1)+I(p^{k-1})\mu(p)+\cdots+I(1)\mu(p^k)=0\\
\mu(1)+\mu(p)+\cdots+\mu(p^k)=0\\
1+(-1)+\mu(p^2)+\mu(p^3)+\cdots+\mu(p^k)=0\\
若\ k=2，则\ \mu(p^2)=0\\
以此类推，\mu(p^k)=0
  $$

由积性函数的定义得知 $\mu(n=\sum_ip_i^{k_i})=\prod_{i}\mu(p_i^{k_i})$

若其中有一个 $i$ 满足 $k_i>1$，则 $\mu(n)=0$

否则所有 $k_i=1$，$\mu(n)=(-1)^m$（$m$ 是 $n$ 的质因数种类数）

由此我们可以看出分析积性函数的一个通用套路：先考虑此函数在质数幂上的表现
