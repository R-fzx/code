(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{2081:function(e,t,n){e.exports=n(2165)()},2106:function(e,t,n){"use strict";var o=a(n(2164)),r=a(n(2107));function a(e){return e&&e.__esModule?e:{default:e}}e.exports={TransitionGroup:r.default,CSSTransitionGroup:o.default}},2107:function(e,t,n){"use strict";t.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=c(n(2167)),a=c(n(0)),i=c(n(2081)),s=(c(n(2168)),n(2169));function c(e){return e&&e.__esModule?e:{default:e}}i.default.any,i.default.func,i.default.node;var l=function(e){function t(n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n,r));return a.performAppear=function(e,t){a.currentlyTransitioningKeys[e]=!0,t.componentWillAppear?t.componentWillAppear(a._handleDoneAppearing.bind(a,e,t)):a._handleDoneAppearing(e,t)},a._handleDoneAppearing=function(e,t){t.componentDidAppear&&t.componentDidAppear(),delete a.currentlyTransitioningKeys[e];var n=(0,s.getChildMapping)(a.props.children);n&&n.hasOwnProperty(e)||a.performLeave(e,t)},a.performEnter=function(e,t){a.currentlyTransitioningKeys[e]=!0,t.componentWillEnter?t.componentWillEnter(a._handleDoneEntering.bind(a,e,t)):a._handleDoneEntering(e,t)},a._handleDoneEntering=function(e,t){t.componentDidEnter&&t.componentDidEnter(),delete a.currentlyTransitioningKeys[e];var n=(0,s.getChildMapping)(a.props.children);n&&n.hasOwnProperty(e)||a.performLeave(e,t)},a.performLeave=function(e,t){a.currentlyTransitioningKeys[e]=!0,t.componentWillLeave?t.componentWillLeave(a._handleDoneLeaving.bind(a,e,t)):a._handleDoneLeaving(e,t)},a._handleDoneLeaving=function(e,t){t.componentDidLeave&&t.componentDidLeave(),delete a.currentlyTransitioningKeys[e];var n=(0,s.getChildMapping)(a.props.children);n&&n.hasOwnProperty(e)?a.keysToEnter.push(e):a.setState(function(t){var n=o({},t.children);return delete n[e],{children:n}})},a.childRefs=Object.create(null),a.state={children:(0,s.getChildMapping)(n.children)},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]},t.prototype.componentDidMount=function(){var e=this.state.children;for(var t in e)e[t]&&this.performAppear(t,this.childRefs[t])},t.prototype.componentWillReceiveProps=function(e){var t=(0,s.getChildMapping)(e.children),n=this.state.children;for(var o in this.setState({children:(0,s.mergeChildMappings)(n,t)}),t){var r=n&&n.hasOwnProperty(o);!t[o]||r||this.currentlyTransitioningKeys[o]||this.keysToEnter.push(o)}for(var a in n){var i=t&&t.hasOwnProperty(a);!n[a]||i||this.currentlyTransitioningKeys[a]||this.keysToLeave.push(a)}},t.prototype.componentDidUpdate=function(){var e=this,t=this.keysToEnter;this.keysToEnter=[],t.forEach(function(t){return e.performEnter(t,e.childRefs[t])});var n=this.keysToLeave;this.keysToLeave=[],n.forEach(function(t){return e.performLeave(t,e.childRefs[t])})},t.prototype.render=function(){var e=this,t=[],n=function(n){var o=e.state.children[n];if(o){var i="string"!=typeof o.ref,s=e.props.childFactory(o),c=function(t){e.childRefs[n]=t};s===o&&i&&(c=(0,r.default)(o.ref,c)),t.push(a.default.cloneElement(s,{key:n,ref:c}))}};for(var i in this.state.children)n(i);var s=o({},this.props);return delete s.transitionLeave,delete s.transitionName,delete s.transitionAppear,delete s.transitionEnter,delete s.childFactory,delete s.transitionLeaveTimeout,delete s.transitionEnterTimeout,delete s.transitionAppearTimeout,delete s.component,a.default.createElement(this.props.component,s,t)},t}(a.default.Component);l.displayName="TransitionGroup",l.propTypes={},l.defaultProps={component:"span",childFactory:function(e){return e}},t.default=l,e.exports=t.default},2108:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=!("undefined"==typeof window||!window.document||!window.document.createElement),e.exports=t.default},2109:function(e,t,n){"use strict";t.__esModule=!0,t.nameShape=void 0,t.transitionTimeout=function(e){var t="transition"+e+"Timeout",n="transition"+e;return function(e){if(e[n]){if(null==e[t])return new Error(t+" wasn't supplied to CSSTransitionGroup: this can cause unreliable animations and won't be supported in a future version of React. See https://fb.me/react-animation-transition-group-timeout for more information.");if("number"!=typeof e[t])return new Error(t+" must be a number (in milliseconds)")}return null}};r(n(0));var o=r(n(2081));function r(e){return e&&e.__esModule?e:{default:e}}t.nameShape=o.default.oneOfType([o.default.string,o.default.shape({enter:o.default.string,leave:o.default.string,active:o.default.string}),o.default.shape({enter:o.default.string,enterActive:o.default.string,leave:o.default.string,leaveActive:o.default.string,appear:o.default.string,appearActive:o.default.string})])},2110:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(0),r=n.n(o),a=n(76),i=(n(2177),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["PureComponent"]),i(t,[{key:"render",value:function(){var e=this.props.onRef;return r.a.createElement("div",{className:"Comments-pattern-loading",ref:e},r.a.createElement(a.a,null))}}]),t}()},2111:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.selectedKey,i=void 0===a?"selectedProps":a,s=n.dropedKey,c=void 0===s?"dropedProps":s;return Object.keys(e).reduce(function(n,a){var s=t.includes(a)?i:c;return o({},n,r({},s,o({},n[s],r({},a,e[a]))))},{})}},2112:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var o=function(e){return"article"===e?"Post":"book_review"===e?"BookReview":""+e.slice(0,1).toUpperCase()+e.slice(1)}},2146:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(2),i=n.n(a),s=n(3),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var l=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return a.handleClick=function(){var e=a.props;(0,e.onSelect)(e.page)},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),c(t,[{key:"render",value:function(){var e=this.props,t=e.text,n=e.isCurrent,o=e.className;return r.a.createElement(s.c,{preset:s.b.Plain,className:i()("PaginationButton",{"PaginationButton--current":n},o),onClick:this.handleClick,disabled:n},t)}}]),t}(),u=(n(2176),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function m(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Array.from({length:t},function(t,n){return n+e})},d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),u(t,[{key:"render",value:function(){var e,t=this.props,n=t.onSelect,o=t.className,a=t.clickCallback,s=this.props.current,c=this.props.total,u=a&&(e=a,function(){e.apply(void 0,arguments)})||n,d=function(e,t){var n="...";return t<=5?p(1,t):e>t-3?[1,n].concat(m(p(t-3,3)),[t]):e<=3?[1].concat(m(p(2,3)),[n,t]):[1,n].concat(m(p(e-Math.floor(1.5),3)),[n,t])}(s,c);return r.a.createElement("div",{className:i()("Pagination",o)},s>1&&s<=c&&r.a.createElement(l,{className:"PaginationButton-prev",onSelect:u,text:"上一页",page:s-1}),d.map(function(e,t){return"number"==typeof e?r.a.createElement(l,{onSelect:u,text:e,page:e,key:t,isCurrent:s===e}):r.a.createElement("button",{disabled:!0,key:t,className:"PaginationButton PaginationButton--ellipsis"},e)}),s>0&&s<c&&r.a.createElement(l,{className:"PaginationButton-next",onSelect:u,text:"下一页",page:s+1}))}}]),t}();d.defaultProps={current:1,total:1,onSelect:function(){}},n.d(t,"a",function(){return d})},2164:function(e,t,n){"use strict";t.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=l(n(0)),a=l(n(2081)),i=l(n(2107)),s=l(n(2170)),c=n(2109);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}c.nameShape.isRequired,a.default.bool,a.default.bool,a.default.bool,(0,c.transitionTimeout)("Appear"),(0,c.transitionTimeout)("Enter"),(0,c.transitionTimeout)("Leave");var m=function(e){function t(){var n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=Array(a),c=0;c<a;c++)i[c]=arguments[c];return n=o=u(this,e.call.apply(e,[this].concat(i))),o._wrapChild=function(e){return r.default.createElement(s.default,{name:o.props.transitionName,appear:o.props.transitionAppear,enter:o.props.transitionEnter,leave:o.props.transitionLeave,appearTimeout:o.props.transitionAppearTimeout,enterTimeout:o.props.transitionEnterTimeout,leaveTimeout:o.props.transitionLeaveTimeout},e)},u(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){return r.default.createElement(i.default,o({},this.props,{childFactory:this._wrapChild}))},t}(r.default.Component);m.displayName="CSSTransitionGroup",m.propTypes={},m.defaultProps={transitionAppear:!1,transitionEnter:!0,transitionLeave:!0},t.default=m,e.exports=t.default},2165:function(e,t,n){"use strict";var o=n(492),r=n(372),a=n(2166);e.exports=function(){function e(e,t,n,o,i,s){s!==a&&r(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=o,n.PropTypes=n,n}},2166:function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},2167:function(e,t){e.exports=function(){for(var e=arguments.length,t=[],n=0;n<e;n++)t[n]=arguments[n];if(0!==(t=t.filter(function(e){return null!=e})).length)return 1===t.length?t[0]:t.reduce(function(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}})}},2168:function(e,t,n){e.exports=n(45)(21)},2169:function(e,t,n){"use strict";t.__esModule=!0,t.getChildMapping=function(e){if(!e)return e;var t={};return o.Children.map(e,function(e){return e}).forEach(function(e){t[e.key]=e}),t},t.mergeChildMappings=function(e,t){function n(n){return t.hasOwnProperty(n)?t[n]:e[n]}e=e||{},t=t||{};var o={},r=[];for(var a in e)t.hasOwnProperty(a)?r.length&&(o[a]=r,r=[]):r.push(a);var i=void 0,s={};for(var c in t){if(o.hasOwnProperty(c))for(i=0;i<o[c].length;i++){var l=o[c][i];s[o[c][i]]=n(l)}s[c]=n(c)}for(i=0;i<r.length;i++)s[r[i]]=n(r[i]);return s};var o=n(0)},2170:function(e,t,n){"use strict";t.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=p(n(2171)),a=p(n(2173)),i=p(n(2174)),s=n(2175),c=p(n(0)),l=p(n(2081)),u=n(21),m=n(2109);function p(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=[];s.transitionEnd&&f.push(s.transitionEnd),s.animationEnd&&f.push(s.animationEnd);l.default.node,m.nameShape.isRequired,l.default.bool,l.default.bool,l.default.bool,l.default.number,l.default.number,l.default.number;var h=function(e){function t(){var n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=d(this,e.call.apply(e,[this].concat(a))),o.componentWillAppear=function(e){o.props.appear?o.transition("appear",e,o.props.appearTimeout):e()},o.componentWillEnter=function(e){o.props.enter?o.transition("enter",e,o.props.enterTimeout):e()},o.componentWillLeave=function(e){o.props.leave?o.transition("leave",e,o.props.leaveTimeout):e()},d(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){this.classNameAndNodeQueue=[],this.transitionTimeouts=[]},t.prototype.componentWillUnmount=function(){this.unmounted=!0,this.timeout&&clearTimeout(this.timeout),this.transitionTimeouts.forEach(function(e){clearTimeout(e)}),this.classNameAndNodeQueue.length=0},t.prototype.transition=function(e,t,n){var o=(0,u.findDOMNode)(this);if(o){var i=this.props.name[e]||this.props.name+"-"+e,c=this.props.name[e+"Active"]||i+"-active",l=null,m=void 0;(0,r.default)(o,i),this.queueClassAndNode(c,o);var p=function(e){e&&e.target!==o||(clearTimeout(l),m&&m(),(0,a.default)(o,i),(0,a.default)(o,c),m&&m(),t&&t())};n?(l=setTimeout(p,n),this.transitionTimeouts.push(l)):s.transitionEnd&&(m=function(e,t){return f.length?f.forEach(function(n){return e.addEventListener(n,t,!1)}):setTimeout(t,0),function(){f.length&&f.forEach(function(n){return e.removeEventListener(n,t,!1)})}}(o,p))}else t&&t()},t.prototype.queueClassAndNode=function(e,t){var n=this;this.classNameAndNodeQueue.push({className:e,node:t}),this.rafHandle||(this.rafHandle=(0,i.default)(function(){return n.flushClassNameAndNodeQueue()}))},t.prototype.flushClassNameAndNodeQueue=function(){this.unmounted||this.classNameAndNodeQueue.forEach(function(e){e.node.scrollTop,(0,r.default)(e.node,e.className)}),this.classNameAndNodeQueue.length=0,this.rafHandle=null},t.prototype.render=function(){var e=o({},this.props);return delete e.name,delete e.appear,delete e.enter,delete e.leave,delete e.appearTimeout,delete e.enterTimeout,delete e.leaveTimeout,delete e.children,c.default.cloneElement(c.default.Children.only(this.props.children),e)},t}(c.default.Component);h.displayName="CSSTransitionGroupChild",h.propTypes={},t.default=h,e.exports=t.default},2171:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.classList?e.classList.add(t):(0,a.default)(e,t)||("string"==typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))};var o,r=n(2172),a=(o=r)&&o.__esModule?o:{default:o};e.exports=t.default},2172:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")},e.exports=t.default},2173:function(e,t,n){"use strict";function o(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}e.exports=function(e,t){e.classList?e.classList.remove(t):"string"==typeof e.className?e.className=o(e.className,t):e.setAttribute("class",o(e.className&&e.className.baseVal||"",t))}},2174:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(2108),a=(o=r)&&o.__esModule?o:{default:o};var i,s="clearTimeout",c=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-u)),o=setTimeout(e,n);return u=t,o},l=function(e,t){return e+(e?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};a.default&&["","webkit","moz","o","ms"].some(function(e){var t=l(e,"request");if(t in window)return s=l(e,"cancel"),c=function(e){return window[t](e)}});var u=(new Date).getTime();(i=function(e){return c(e)}).cancel=function(e){window[s]&&"function"==typeof window[s]&&window[s](e)},t.default=i,e.exports=t.default},2175:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.animationEnd=t.animationDelay=t.animationTiming=t.animationDuration=t.animationName=t.transitionEnd=t.transitionDuration=t.transitionDelay=t.transitionTiming=t.transitionProperty=t.transform=void 0;var o,r=n(2108);var a="transform",i=void 0,s=void 0,c=void 0,l=void 0,u=void 0,m=void 0,p=void 0,d=void 0,f=void 0,h=void 0,v=void 0;if(((o=r)&&o.__esModule?o:{default:o}).default){var y=function(){for(var e=document.createElement("div").style,t={O:function(e){return"o"+e.toLowerCase()},Moz:function(e){return e.toLowerCase()},Webkit:function(e){return"webkit"+e},ms:function(e){return"MS"+e}},n=Object.keys(t),o=void 0,r=void 0,a="",i=0;i<n.length;i++){var s=n[i];if(s+"TransitionProperty"in e){a="-"+s.toLowerCase(),o=t[s]("TransitionEnd"),r=t[s]("AnimationEnd");break}}!o&&"transitionProperty"in e&&(o="transitionend");!r&&"animationName"in e&&(r="animationend");return e=null,{animationEnd:r,transitionEnd:o,prefix:a}}();i=y.prefix,t.transitionEnd=s=y.transitionEnd,t.animationEnd=c=y.animationEnd,t.transform=a=i+"-"+a,t.transitionProperty=l=i+"-transition-property",t.transitionDuration=u=i+"-transition-duration",t.transitionDelay=p=i+"-transition-delay",t.transitionTiming=m=i+"-transition-timing-function",t.animationName=d=i+"-animation-name",t.animationDuration=f=i+"-animation-duration",t.animationTiming=h=i+"-animation-delay",t.animationDelay=v=i+"-animation-timing-function"}t.transform=a,t.transitionProperty=l,t.transitionTiming=m,t.transitionDelay=p,t.transitionDuration=u,t.transitionEnd=s,t.animationName=d,t.animationDuration=f,t.animationTiming=h,t.animationDelay=v,t.animationEnd=c,t.default={transform:a,end:s,property:l,timing:m,delay:p,duration:u}},2176:function(e,t,n){},2177:function(e,t,n){},2178:function(e,t,n){},2179:function(e,t,n){var o=n(830),r=n(261),a=n(374),i=Math.max,s=Math.min;e.exports=function(e,t,n){var c=null==e?0:e.length;if(!c)return-1;var l=c-1;return void 0!==n&&(l=a(n),l=n<0?i(c+l,0):s(l,c-1)),o(e,r(t,3),l,!0)}},2180:function(e,t,n){},2181:function(e,t,n){},2182:function(e,t,n){},2183:function(e,t,n){},2184:function(e,t,n){},2185:function(e,t,n){},2186:function(e,t,n){},2187:function(e,t,n){},2188:function(e,t,n){},2189:function(e,t){e.exports={attributes:{width:"72px",height:"58px",viewBox:"0 0 72 58"},content:'<defs>         <path d="M0.00434937116,11.7604183 C0.0014585125,11.8367351 0,11.9134174 0,11.9904392 L0,52.0095608 C0,55.3137533 2.68603825,58 5.99943435,58 L66.0005656,58 C69.3089213,58 72,55.317989 72,52.0095608 L72,11.9904392 C72,8.68624675 69.3139617,6 66.0005656,6 L31.1520961,6 L30.2346555,3.7077864 C29.4154984,1.66113281 26.9585394,0 24.7478675,0 L6.18638069,0 C2.86742525,0 0.139552484,2.68348852 0.0902454792,5.99373937 L0.00434937116,11.7604183 Z" id="path-1"></path>         <mask id="mask-2" maskContentUnits="userSpaceOnUse" maskUnits="objectBoundingBox" x="0" y="0" width="72" height="58" fill="white">             <use xlink:href="#path-1"></use>         </mask>     </defs>     <g id="空状态" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">         <g id="collection" transform="translate(-39.000000, -30.000000)" stroke="#E7EAF1">             <g transform="translate(39.000000, 30.000000)" id="Group-7">                 <g>                     <use id="Combined-Shape" mask="url(#mask-2)" stroke-width="6" xlink:href="#path-1"></use>                     <path d="M36.4126782,38.4800003 L30.2669271,41.2927815 C29.7656337,41.522213 29.4096881,41.2718295 29.4738593,40.716584 L30.2498317,34.0024302 L25.6755762,29.0266708 C25.3024658,28.6208107 25.4306014,28.2049135 25.9785012,28.0943637 L32.6038296,26.7575697 L35.9225353,20.8696 C36.1932338,20.3893332 36.6283715,20.3826781 36.9028211,20.8696 L40.2215268,26.7575697 L46.8468552,28.0943637 C47.3872665,28.2034026 47.5280608,28.6151866 47.1497802,29.0266708 L42.5755247,34.0024302 L43.3514971,40.716584 C43.4147912,41.2642406 43.0666691,41.5253922 42.5584293,41.2927815 L36.4126782,38.4800003 Z" id="Star" stroke-width="3"></path>                 </g>             </g>         </g>     </g>'}},2190:function(e,t,n){},2191:function(e,t,n){},2192:function(e,t,n){},2193:function(e,t,n){},2194:function(e,t,n){},2195:function(e,t,n){},2196:function(e,t,n){},2197:function(e,t,n){},2347:function(e,t,n){},2348:function(e,t,n){},2349:function(e,t,n){},2350:function(e,t,n){},2352:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(4),i=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M12 11l-3.716 3.782a.758.758 0 0 1-1.064 0 .738.738 0 0 1 0-1.052l4.249-4.512a.758.758 0 0 1 1.064 0l4.246 4.512a.738.738 0 0 1 0 1.052.757.757 0 0 1-1.063 0L12.002 11z",fillRule:"evenodd"}))};i.defaultProps={name:"ArrowUp"},t.a=i},2353:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(2),i=n.n(a),s=n(53),c=n.n(s),l=n(5),u=(n(499),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=o=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),o.rootRef=r.a.createRef(),o.unobserve=c.a,o.renderTarget=function(){var e=o.props.item,t=e.content.target,n=t.text,a=t.link,i=e.id,s=e.target,c=e.target,l=(c=void 0===c?{}:c).id,u=c.target,m=void 0===u?{}:u,p=m.type;return s&&"comment"===s.type?o.renderCommentButton(n,{type:p,href:a,byComment:l,target:m,notificationId:i}):r.a.createElement("span",null,a?r.a.createElement("a",{href:a,"data-za-detail-view-id":5109},n):r.a.createElement("span",null,n))},m(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),u(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.addObserve,n=e.item.attachInfo,o=this.rootRef.current;l.default.setModule(o,{module:"Content"},{attached_info_bytes:n}),this.unobserve=t(o)}},{key:"componentWillUnmount",value:function(){this.unobserve()}},{key:"renderCommentButton",value:function(e,t){var n=this,o=t.href,a=t.byComment,i=t.notificationId;return r.a.createElement("a",{href:o+(a?"#comment-"+a+"?notificationId="+i:""),"data-za-detail-view-id":5109,onClick:function(e){e.preventDefault(),n.props.onCommentsModalOpen(t)}},e)}},{key:"render",value:function(){var e,t=this.props.item,n=t.content,o=n.verb,a=n.actors,s=t.isRead;return r.a.createElement("div",{ref:this.rootRef,className:i()("PushNotifications-item",{"PushNotifications-newItem":!s})},r.a.createElement("span",null,(e=a,Array.isArray(e)||(e=[e]),e.map(function(e,t){return r.a.createElement("span",{className:"PushNotifications-actor",key:t},e.link?r.a.createElement("a",{href:e.link,"data-za-detail-view-id":5109},e.name):r.a.createElement("span",null,e.name))})))," ",o," ",this.renderTarget())}}]),t}();t.default=p},2355:function(e,t,n){"use strict";n.r(t);var o,r,a,i,s,c=n(1),l=n.n(c),u=n(0),m=n.n(u),p=n(5),d=n(23),f=n(2),h=n.n(f),v=n(2053),y=n(3),b=n(32),g=(n(2191),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function C(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w="oneself",k="enterprise",P=[{title:"发表澄清声明",image:"https://zhstatic.zhihu.com/assets/report/Statement@3x.png",description:(o={},E(o,w,"个人可以对站内关于自身的不实描述内容发表澄清声明，声明通过审核后，将会以标记的方式形式显示在投诉内容的上方，点击可跳转至您的声明全文。"),E(o,k,"企业可以对站内关于自身的不实描述内容发表澄清声明，声明通过审核后，将会以标记的方式形式显示在投诉内容的上方，点击可跳转至您的声明全文。"),o),defaultReasonIdMap:(r={},E(r,w,46),E(r,k,48),r)},{title:"提交侵权举报",image:"https://zhstatic.zhihu.com/assets/report/Infringement@3x.png",description:m.a.createElement("span",null,"您提交的侵权举报将会根据知乎侵权举报规范进行受理"),defaultReasonIdMap:(a={},E(a,w,47),E(a,k,49),a),memberReasonIdMap:(i={},E(i,w,12),E(i,k,13),i)}],O=(E(s={},k,"当您发现知乎上存在涉嫌侵犯您企业合法权益的内容时，您可以先尝试与作者沟通解决，如沟通无效，也可以通过以下方式向知乎提出诉求。"),E(s,w,"当您发现知乎上存在涉嫌侵犯您个人合法权益的内容时，您可以通过以下方式向知乎提出诉求。"),s),N=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=C(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleClick=function(e){p.default.trackEvent(e,{id:3467,aciton:"Click"})},C(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,m.a.Component),g(t,[{key:"componentDidMount",value:function(){p.default.trackCardShow(null,{id:3466})}},{key:"render",value:function(){var e=this,t=this.props,n=t.onSubMenuEnter,o=t.onBackClick,r=t.activeId,a=t.isMobile,i=t.type,s=["answer","article","pin"].includes(i)?P:P.slice(1),c=function(e,t){return("member"===e?10===t:29===t)?w:k}(i,r);return m.a.createElement("section",{className:h()("ReportInfringement",{"ReportInfringement--mobile":a})},m.a.createElement("p",{className:"ReportInfringement-subtitle"},O[c]),m.a.createElement("ul",{className:"ReportInfringement-list"},s.map(function(t){var o=t.image,r=t.title,a=t.description,s=t.defaultReasonIdMap,l=t.memberReasonIdMap,u=("member"===i?l:s)[c],p=a[c]||a;return m.a.createElement("li",{className:"ReportInfringement-item",key:r,"data-za-module":"Content","data-za-detail-view-path-module_name":r,onClick:function(t){e.handleClick(t.currentTarget),n(u)}},m.a.createElement("img",{className:"ReportInfringement-image",src:o}),m.a.createElement("div",{className:"ReportInfringement-content"},m.a.createElement("h1",{className:"ReportInfringement-itemTitle"},r),m.a.createElement("p",{className:"ReportInfringement-itemDescription"},p)),m.a.createElement(v.a,{className:"ReportInfringement-arrow"}))})),m.a.createElement(b.a,{direction:"horizontal"},m.a.createElement(y.c,{"data-za-module":"Content","data-za-detail-path-view-module_name":"返回",onClick:function(t){e.handleClick(t.currentTarget),o()}},"返回")))}}]),t}(),S=n(26),I=function(e){return"https://www.zhihu.com/account/infringement?"+Object(S.stringify)(e)};n(2192);function R(e){var t=e.infringementType;return m.a.createElement("p",{className:"ReportOrgContent"},"若您已注册机构号，可使用",m.a.createElement("span",{className:"ReportOrgContent-highlight"},"机构号"),"declare"===t?"发表澄清声明":"提交侵权举报","，",m.a.createElement("span",{className:"ReportOrgContent-highlight"},"免提交资质材料"),"。")}n(2193);function _(e){var t=e.infringementType,n=e.isIndividualReason,o=e.onBackClick,r="declare"===t;return m.a.createElement("div",{className:"ReportInfringementMobile"},m.a.createElement("p",{className:"ReportInfringementMobile-text"},"1."," ",r?(n?"个人":"企业")+"可以对站内关于自身的不实描述内容发表澄清声明，声明通过审核后，将会以标记的方式形式显示在投诉内容的上方，点击可跳转至您的声明全文。":"您提交的侵权举报将会根据知乎侵权举报规范进行受理。"),m.a.createElement("p",{className:"ReportInfringementMobile-text"},"2. 根据",m.a.createElement("a",{className:"ReportInfringementMobile-link",href:"https://www.zhihu.com/terms#sec-report",target:"_blank",rel:"noopener noreferrer"},"知乎侵权举报规范"),"，您需按照提示提供完整、有效的证明材料，",r?"以发表澄清声明。":"并规范填写投诉说明。","若您已确认完毕，",m.a.createElement("span",{className:"ReportInfringementMobile-bold"},"请到桌面版网页进行诉求提交。")),!n&&m.a.createElement("p",{className:"ReportInfringementMobile-text"},"若您已注册机构号，可使用机构号"+(r?"发表澄清声明":"提交侵权举报")+"，免提交资质材料。"),m.a.createElement("img",{className:"ReportInfringementMobile-img",src:"https://zhstatic.zhihu.com/report/app_report.png"}),m.a.createElement(y.c,{color:y.a.Blue,preset:y.b.Primary,onClick:o,className:"ReportInfringementMobile-button"},"我知道了"))}n(2194);var j=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function T(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var x=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=T(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleClick=function(e){p.default.trackEvent(null,{id:3469,action:"Click"},{button:{text:e}})},T(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,m.a.Component),j(t,[{key:"componentDidMount",value:function(){p.default.trackCardShow(null,{id:3468})}},{key:"render",value:function(){var e=this,t=this.props,n=t.onBackClick,o=t.urlToken,r=t.type,a=46===t.activeId;return t.isMobile?m.a.createElement(_,{isIndividualReason:a,infringementType:"declare",onBackClick:n}):m.a.createElement("section",{className:"ReportDeclare"},m.a.createElement("div",{className:"ReportDeclare-description"},"当您发现知乎上有关于您",a?"个人":"企业","的侵权内容时，您可通过此方式发表澄清声明。",m.a.createElement("br",null),m.a.createElement("br",null),"申请发表澄清声明的流程如下：",m.a.createElement("ul",null,m.a.createElement("li",null,"1. 在站内写一篇",m.a.createElement("a",{href:"https://zhuanlan.zhihu.com/write",target:"_blank",rel:"noopener noreferrer",onClick:function(){return e.handleClick("澄清声明文章")}},"澄清声明文章"),"并发布。",m.a.createElement("a",{href:"https://zhstatic.zhihu.com/assets/report/template-v2.png",target:"_blank",rel:"noopener noreferrer",onClick:function(){return e.handleClick("查看模版")}},"查看模版"),m.a.createElement("br",null)),m.a.createElement("li",null,"2.返回此页面继续发表声明，您需按照提示提供完整、有效的证明材料。",m.a.createElement("br",null)),m.a.createElement("li",null,"3.审核通过后，侵权纠纷内容上会关联展示您的澄清声明，点击可跳转至您的声明全文。")),!a&&m.a.createElement(R,{infringementType:"declare"})),m.a.createElement(b.a,{direction:"horizontal"},m.a.createElement(y.c,{onClick:n},"返回"),m.a.createElement(y.c,{onClick:function(){return e.handleClick("继续发表声明")},component:"a",href:I({infringementType:"declare",resourceId:o,type:r,reasonType:a?"inflictIndividual":"enterprise"}),className:"ReportDeclare-continue",color:y.a.Blue,preset:y.b.Primary},"继续发表声明")))}}]),t}(),L=(n(2195),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function D(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var A,M,B=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=D(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleClick=function(e){p.default.trackEvent(null,{id:3510,aciton:"Click"},{button:{text:e}})},D(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,m.a.Component),L(t,[{key:"componentDidMount",value:function(){p.default.trackCardShow(null,{id:3509})}},{key:"render",value:function(){var e=this,t=this.props,n=t.onBackClick,o=t.urlToken,r=t.type,a=t.activeId,i="member"===r?12===a:47===a;return t.isMobile?m.a.createElement(_,{isIndividualReason:i,infringementType:"trespass",onBackClick:n}):m.a.createElement("section",{className:"ReportTrespass"},m.a.createElement("p",{className:"ReportTrespass-description"},"根据",m.a.createElement("a",{href:"https://www.zhihu.com/terms#sec-report",onClick:function(){e.handleClick("知乎侵权举报规范")}},"知乎侵权举报规范"),"，您需按照提示提供完整、有效的证明材料，并规范填写投诉说明。若您已确认完毕，请继续提交举报信息。"),!i&&m.a.createElement(R,{infringementType:"trespass"}),m.a.createElement(b.a,{direction:"horizontal"},m.a.createElement(y.c,{onClick:function(){e.handleClick("返回"),n()}},"返回"),m.a.createElement(y.c,{onClick:function(){e.handleClick("继续提交举报")},component:"a",href:I({resourceId:o,type:r,reasonType:i?"inflictIndividual":"enterprise"}),className:"ReportTrespass-continue",color:y.a.Blue,preset:y.b.Primary},"继续提交举报")))}}]),t}(),F=[{id:0,text:"举报",childIds:[1,2,3,4,5,21,7,8,9]},{id:1,text:"低质问题",types:["question"],childIds:[23,33,34,15,35,27,22]},{id:2,text:"垃圾广告信息",reason:"spam",copywriter:{title:"举报说明",placeholder:"举报详细说明（选填）",isRequired:!1},disabled:!0},{id:3,text:"不友善行为",types:["answer","comment","article","column","pin","book_review","favlist","discussion_review"],childIds:[40,41]},{id:4,text:"有害信息",childIds:[19,30,39,26,18,28]},{id:5,text:"涉嫌侵权",childIds:[20,29,12],types:["question","answer","comment","article","column","pin","book_review"],reason:"infringement",disabled:!0},{id:6,types:[]},{id:7,text:"其他",reason:"old",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:8,reason:"direction",shouldShow:function(e){return e.isColumnArticle}},{id:9,reason:"tipjar",shouldShow:function(e){return e.isTipjarEnabled}},{id:10,reason:"mention"},{id:11,reason:"privacy",disabled:!0},{id:12,reason:"enterprise",disabled:!0,customComponent:N},{id:13,reason:"copy",copywriter:{title:"原文链接或出处",placeholder:"填写原文链接或描述内容出处（必填）"},disabled:!0},{id:14,reason:"defamation",disabled:!0},{id:15,reason:"abuse"},{id:16,reason:"intention"},{id:17,reason:"spam"},{id:18,reason:"illegality",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:19,reason:"politics"},{id:20,reason:"repost",copywriter:{title:"举报说明",placeholder:"原文链接或补充说明（必填）"},types:["answer","article","column","pin","book_review"],disabled:!0},{id:21,reason:"temptation",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0,types:["answer","comment","article","column"]},{id:22,reason:"personal"},{id:23,reason:"ambiguity"},{id:24,reason:"worthless"},{id:25,reason:"rumour"},{id:26,reason:"suicide",types:["question","answer","article","column","pin","book_review","comment"]},{id:27,reason:"medicine"},{id:28,reason:"superstition"},{id:29,reason:"oneself",disabled:!0,customComponent:N},{id:30,reason:"porn"},{id:31,reason:"pirate"},{id:32,reason:"invalid"},{id:33,reason:"subjective"},{id:34,reason:"rumour"},{id:35,reason:"provoke"},{id:36,reason:"edit"},{id:37,reason:"harassment"},{id:38,reason:"hatred"},{id:39,text:"不实信息",types:["answer","comment","article","column","pin","book_review"],childIds:[42,43,44,45]},{id:40,reason:"abuse",text:"骚扰、辱骂、歧视等"},{id:41,reason:"unfriendly",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:42,reason:"untruth_science",text:"科学类不实信息",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:43,reason:"untruth_rumor",text:"社会谣言类不实信息",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:44,reason:"untruth_fake_profile",text:"编造经历类不实信息",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:45,text:"诽谤等侵权信息",childIds:[20,29,12]},{id:46,customComponent:x,text:"发表澄清声明",reason:"declare",subtitle:"个人侵权"},{id:47,customComponent:B,text:"提交侵权举报",reason:"trespass",subtitle:"个人侵权"},{id:48,customComponent:x,text:"发表澄清声明",reason:"declare",subtitle:"企业侵权"},{id:49,customComponent:B,text:"提交侵权举报",reason:"trespass",subtitle:"企业侵权"}],q=[{id:0,text:"举报",childIds:[1,2,3,4]},{id:1,text:"垃圾广告信息",reason:"spam"},{id:2,text:"不友善行为",reason:"unkind"},{id:3,text:"有害信息",reason:"imitation"},{id:4,text:"其他",reason:"old",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0}],z=[{id:0,text:"举报",childIds:[1,2,3]},{id:1,reason:"abuse"},{id:2,reason:"harassment"},{id:3,reason:"spam"}],V=[{id:0,text:"举报",childIds:[1,4,6,7]},{id:1,text:"冒充我或他人",childIds:[8,9],reason:"fake",disabled:!0},{id:2,reason:"abuse",text:"发过辱骂我或他人的内容"},{id:3,reason:"illegality",text:"发过违反法律法规的内容"},{id:4,reason:"spam",text:"垃圾广告帐号"},{id:5,reason:"politics",text:"发过政治敏感内容"},{id:6,reason:"profile",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:7,reason:"old",text:"其他",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:8,text:"冒充我",subtitle:"请选择举报理由",reason:"oneself",disabled:!0,childIds:[10,11]},{id:9,reason:"impersonate",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},text:"冒充他人",disabled:!0},{id:10,text:"个人侵权",isRequired:!0,customComponent:N},{id:11,text:"企业侵权",isRequired:!0,customComponent:N},{id:12,isRequired:!0,customComponent:B,text:"提交侵权举报",reason:"trespass",subtitle:"个人侵权"},{id:13,isRequired:!0,customComponent:B,text:"提交侵权举报",reason:"trespass",subtitle:"企业侵权"}],U=n(40),W=n.n(U),H=n(249),K=n(2055),G=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Q,$,Z=(M=A=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.handleClick=e.handleClick.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),G(t,[{key:"handleClick",value:function(){var e=this.props,t=e.id,n=e.reason,o=e.disabled,r=e.onSubMenuEnter,a=e.onItemSelect;n&&!o?a(t):r(t)}},{key:"render",value:function(){var e=this.props,t=e.reason,n=e.text,o=e.disabled,r=e.isSelected,a=e.id,i=n||H.b[t];return Boolean(t&&!o)?m.a.createElement("label",{className:"ReportMenu-item",htmlFor:t},m.a.createElement("div",{className:"ReportMenu-itemValue needsclick"},i),m.a.createElement("input",{className:"ReportMenu-itemCheck",type:"radio",name:"report",value:a,id:t,checked:r,onChange:this.handleClick}),m.a.createElement(K.a,{size:18,className:"ReportMenu-itemCheckIcon",name:"checkRound"})):m.a.createElement("button",{className:"ReportMenu-item",onClick:this.handleClick},m.a.createElement("span",{className:"ReportMenu-itemValue"},i),m.a.createElement(v.a,{size:18}))}}]),t}(),A.propTypes={id:l.a.number.isRequired,reason:l.a.string,text:l.a.string,disabled:l.a.bool,isSelected:l.a.bool,onSubMenuEnter:l.a.func.isRequired,onItemSelect:l.a.func.isRequired},M),J=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Y,X,ee=($=Q=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),J(t,[{key:"render",value:function(){switch(this.props.reason){case"privacy":return m.a.createElement("div",{className:"ReportMenu-inner"},m.a.createElement("div",{className:"ReportMenu-paragraph"},"您好，当您发现知乎上有泄漏您隐私的内容时，您可向知乎进行举报。 请您把以下内容通过邮件发送到 ",m.a.createElement("a",{className:"ReportMenu-link",href:"mailto:i@zhihu.com"},"i@zhihu.com")," 邮箱，我们会尽快处理。"),m.a.createElement("ul",{className:"ReportMenu-paragraph"},m.a.createElement("li",null,"1. 您认为哪些内容泄露了您的隐私？（请在邮件中列出您举报的内容、链接地址，并给出简短的说明）"),m.a.createElement("li",null,"2. 您是谁？（身份证明材料，可以是身份证或护照等证件）")),m.a.createElement("div",{className:"ReportMenu-paragraph ReportMenu-paragraph--light"},"邮件格式请参考",m.a.createElement("a",{className:"ReportMenu-link--light",href:"https://www.zhihu.com/terms#sec-report",target:"_blank",rel:"noopener noreferrer"},"这里"),"；"));case"defamation":return m.a.createElement("div",{className:"ReportMenu-inner"},m.a.createElement("div",{className:"ReportMenu-paragraph"},"您好，当您发现知乎上有诽谤您的内容时，您可以向知乎进行举报。 请您把以下内容通过邮件发送到",m.a.createElement("a",{className:"ReportMenu-link",href:"mailto:i@zhihu.com"}," ","i@zhihu.com"," "),"邮箱，我们会尽快处理。"),m.a.createElement("ul",{className:"ReportMenu-paragraph"},m.a.createElement("li",null,"1. 您举报的内容以及侵犯了您什么权益？（请在邮件中列出您举报的内容、链接地址，并给出简短的说明）"),m.a.createElement("li",null,"2. 您是谁？（身份证明材料，可以是身份证或护照等证件）")),m.a.createElement("div",{className:"ReportMenu-paragraph ReportMenu-paragraph--light"},"邮件格式请参考 ",m.a.createElement("a",{className:"ReportMenu-link--light",href:"https://www.zhihu.com/terms#sec-report",target:"_blank",rel:"noopener noreferrer"},"这里")," ；"));default:return null}}}]),t}(),Q.propTypes={reason:l.a.string.isRequired},$),te=n(46),ne=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var oe=(X=Y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),ne(t,[{key:"render",value:function(){var e=this.props,t=e.copywriter.placeholder,n=e.onDetailInput,o=e.errorText,r=e.checkCustomReasonContent;return m.a.createElement("div",{className:"ReportMenu-inner"},m.a.createElement(te.a,{multiline:!0,grey:!0,rows:5,className:"ReportMenu-textarea",placeholder:t,onChange:function(e){return n(e.target.value)},onBlur:r}),m.a.createElement("div",{className:"ReportMenu-errorText"},o))}}]),t}(),Y.propTypes={onDetailInput:l.a.func.isRequired,copywriter:l.a.object,errorText:l.a.string},X),re=(n(2196),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var ae,ie,se=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),re(t,[{key:"render",value:function(){var e=this.props,t=e.checked,n=e.onChange,o=e.name,r=e.text,a=e.desc,i=o||r;return m.a.createElement("div",null,m.a.createElement("label",{className:"ReportOption-check",htmlFor:i},m.a.createElement("input",{type:"checkbox",name:i,checked:t,onChange:n}),m.a.createElement("span",null,"同时",r)),a&&m.a.createElement("div",{className:"ReportOption-desc"},a))}}]),t}(),ce=function(e){return e.length>150?{isLegal:!1,errorReason:H.a.contentTooLong}:/[\u4e00-\u9fa5a-zA-Z0-9]/.test(e)?{isLegal:!0,errorReason:""}:{isLegal:!1,errorReason:H.a.contentIllegal}},le=(n(2197),function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,r=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(o=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){r=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(r)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},me=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function pe(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var de,fe,he=(ie=ae=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=pe(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={blockChecked:null,commentChecked:null,activeId:0,parentId:null,selectedId:null,errorText:"",isMobile:!1,isSubmiting:!1,isSubmited:!1,path:[]},o.menuItems={},o.getReportText=function(e){if(!e)return"";var t=o.props.nodes[e];return t&&(t.text||H.b[t.reason])||""},o.getReportLevel=function(){return"第 "+(o.state.path.length+1)+" 级"},o.handleItemSelect=function(e){var t=o.selectedId===e?null:e;o.setState({selectedId:t});var n=o.props,r=n.zaEnabled,a=n.type;t&&r&&p.default.trackEvent(null,{action:"Select",element:"Menu",id:2883,name:o.getReportLevel()},{button:{text:o.getReportText(e)},report:{id:e,type:a}})},o.handleSubMenuEnter=function(e){o.setState(function(t){var n=t.activeId,o=t.path;return{activeId:e,parentId:n,selectedId:null,path:o.concat([e])}});var t=o.props,n=t.zaEnabled,r=t.type;n&&p.default.trackEvent(null,{action:"Expand",element:"Menu",id:2883,name:o.getReportLevel()},{button:{text:o.getReportText(e)},report:{id:e,type:r}})},o.getCommentChecked=function(){var e=o.state,t=e.commentChecked,n=e.parentId,r=e.activeId;return"boolean"==typeof t?t:[2,3].includes(n||r)},o.handleDetailInput=function(e){o.setState({customReason:e,errorText:""})},o.handleBackClick=function(){var e=o.props.nodes,t=o.state,n=t.parentId,r=t.path,a=Object.keys(e).find(function(t){var o=e[t].childIds;return o&&o.includes(n)});o.setState({activeId:n,parentId:a&&Number(a),selectedId:null,hasWarning:!1,customReason:"",errorText:"",path:r.slice(0,-1)});var i=o.props,s=i.zaEnabled,c=i.type;s&&p.default.trackEvent(null,{action:"Back",element:"Button",id:2884,name:o.getReportLevel()},{report:{id:o.state.activeId,type:c}})},o.handleSubmitAppeal=function(){var e="",t=o.state.activeId,n=o.props,r=n.type,a=n.urlToken,i=n.nodes;"enterprise"===i[t].reason||13===t?e="org":"oneself"!==i[t].reason&&37!==t||(e="people"),window.open("//www.zhihu.com/account/complaints/"+e+"/"+r+"/"+a)},o.handleSubmit=function(){var e=o.state,t=e.selectedId,n=e.customReason,r=e.activeId,a=e.parentId,i=o.getCommentChecked();if(o.isSubmitEnabled()&&o.checkCustomReasonContent()){var s=o.props,c=s.nodes,l=s.onSubmit,u=s.onDeleteComment,m=c[t||r],d=m.reason,f=m.id;o.setState({isSubmiting:!0});var h=l({reason:d,customReason:n});h&&h.then?h.then(o.submitEnd):o.submitEnd();var v=u&&[2,3].includes(a||r),y=o.props,b=y.zaEnabled,g=y.type;b&&(p.default.trackEvent(null,{id:2885,name:o.getReportLevel(),action:"Click"},{report:{type:g},button:{text:o.getReportText(f)}}),p.default.trackEvent(o,ue({action:"Report",element:"Button"},v&&{id:3039,name:d}),ue({report:{id:f,type:g}},v&&{button:{text:i?"举报并删除":"仅举报"}})))}},o.submitEnd=function(e){o.setState({isSubmiting:!1,isSubmited:!0});var t=o.state.blockChecked,n=o.props,r=n.onBlockUser,a=n.onDeleteComment,i=n.onEnd;Promise.all([t&&r&&r(),o.getCommentChecked()&&a&&a()].map(function(e){return Promise.resolve(e).catch(function(e){return e})})).then(function(t){var n=le(t,2),o=n[0],r=n[1];i&&i({result:e,blockUserResult:o,commentDeleteResult:r})})},o.checkCustomReasonContent=function(){var e=o.state,t=e.activeId,n=e.customReason,r=o.props.nodes[t].copywriter;if((14===t||24===t||Boolean(r))&&n){var a=ce(n),i=a.isLegal,s=a.errorReason;if(!i)return o.setState({errorText:s}),!1}return!0},pe(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),me(t,[{key:"componentDidMount",value:function(){var e=this.props.type,t=W()(navigator.userAgent);this.setState({isMobile:t.Mobile}),p.default.trackCardShow(null,{id:2890},{button:{text:e}})}},{key:"componentWillUpdate",value:function(e,t){var n=this.state.activeId,o=t.activeId,r=this.props,a=r.nodes,i=r.onContentChange;if(o!==n){var s=a[o],c=s.reason,l=s.text,u=s.childIds,m=s.copywriter,p=s.subtitle;i(l||H.b[c],p||m&&m.title||(u?void 0:""))}}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.zaEnabled,n=e.type,o=this.state.isSubmited;t&&!o&&p.default.trackEvent(null,{id:4328,action:"Close",name:this.getReportLevel()},{report:{type:n}})}},{key:"isSubmitEnabled",value:function(){var e=this.state,t=e.selectedId,n=e.activeId,o=e.customReason,r=this.props.nodes;return t||(Boolean(r[n].copywriter)||14===n||24===n)&&(!1===r[n].copywriter.isRequired||o)}},{key:"render",value:function(){var e=this,t=this.props,n=t.nodes,o=t.options,r=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(t,["nodes","options"]),a=this.state,i=a.activeId,s=a.parentId,c=a.selectedId,l=a.errorText,u=a.isMobile,p=n[i],d=p.reason,f=p.childIds,v=p.copywriter,g=p.customComponent;if(void 0!==g)return m.a.createElement(g,ue({onBackClick:this.handleBackClick,onItemSelect:this.handleItemSelect,onSubMenuEnter:this.handleSubMenuEnter},this.props,this.state));var C=Boolean(f),E=14===i||24===i||Boolean(v),w=C&&m.a.createElement("div",{className:"ReportMenu-inner ReportMenu-options"},f.map(function(e){return n[e]}).filter(function(e){return e&&(!e.shouldShow||e.shouldShow(r))}).map(function(t){return m.a.createElement(Z,ue({ref:function(n){e.menuItems[t.id]=n},key:t.id},t,{isSelected:c===t.id,onSubMenuEnter:e.handleSubMenuEnter,onItemSelect:e.handleItemSelect}))})," ")||E&&m.a.createElement(oe,{onDetailInput:this.handleDetailInput,copywriter:v,errorText:l,checkCustomReasonContent:this.checkCustomReasonContent})||m.a.createElement(ee,{isMobile:u,reason:d}),k=C&&r.talkerToken&&m.a.createElement(se,{checked:this.state.blockChecked,text:"将此人屏蔽",onChange:function(t){return e.setState({blockChecked:t.target.checked})}}),P=s||i,O=r.onDeleteComment&&[2,3].includes(P)&&m.a.createElement(se,{checked:this.getCommentChecked(),desc:Boolean(P)&&"社区鼓励举报"+n[P].text+"，同时可以直接删除该评论，删除操作并不影响对违规内容和违规用户的处理。",onChange:function(t){return e.setState({commentChecked:t.target.checked})},text:"删除该评论"}),N=this.props.isSubmiting;return m.a.createElement("div",{className:h()("ReportMenu",{"ReportMenu-mobile":u})},w,(k||O)&&m.a.createElement("div",null,k,O,o),m.a.createElement(b.a,{direction:"horizontal"},"number"==typeof s&&m.a.createElement(y.c,{onClick:this.handleBackClick}," 返回 "),C||E?m.a.createElement(y.c,{className:"ReportMenu-button",disabled:N||!this.isSubmitEnabled(),onClick:this.handleSubmit,color:"blue",preset:"primary"},"举报"):!u&&m.a.createElement(y.c,{onClick:this.handleSubmitAppeal,preset:"primary",color:"blue"},"进入诉求提交页面")))}}]),t}(),ae.propTypes={nodes:l.a.object.isRequired,onContentChange:l.a.func.isRequired,onSubmit:l.a.func.isRequired,onEnd:l.a.func,onBlockUser:l.a.func,onDeleteComment:l.a.func,isColumnArticle:l.a.bool,isTipjarEnabled:l.a.bool},ie),ve=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},ye=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function be(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var ge,Ce,Ee=(fe=de=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=be(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.filterNodes=function(e,t,n){var o=e.filter(function(e){return!!e.isRequired||(-1!=["infringement","repost","oneself","enterprise","fake"].indexOf(e.reason)||0===e.id||("question"!==t||-1==["closed","suggested","evaluated","locked"].indexOf(n)||0===e.id)&&("member"!==t||-1==["ban","hang"].indexOf(n)||"profile"===e.reason))});return 1===o.length&&0===o[0].id&&(o=[]),o},be(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),ye(t,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.status,o=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(e,["type","status"]),r=void 0;return r="message"===t?z:"member"===t?V:"favlist"===t?q:F.filter(function(e){return!e.types||e.types.includes(t)}),r=this.filterNodes(r,t,n),m.a.createElement(he,ve({nodes:r.reduce(function(e,t){return ve({},e,(n={},o=t.id,r=t,o in n?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r,n));var n,o,r},{})},o,{type:t}))}}]),t}(),de.propTypes={type:l.a.string.isRequired},fe),we=n(2111),ke=n(2112),Pe=n(41),Oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Ne=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function Se(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Ie="请选择举报理由",Re="举报",_e=(Ce=ge=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=Se(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={title:void 0!==o.props.title?o.props.title:Re,subtitle:void 0!==o.props.subtitle?o.props.subtitle:Ie},o.handleSubmit=function(e){var t=e.reason,n=e.customReason,r=o.props,a=r.urlToken,i=r.type;return o.props.doReport(a,i,t,n)},o.handleContentChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ie;o.setState({title:e,subtitle:t})},o.handleClose=function(){o.props.zaEnabled&&p.default.trackEvent(o.container,{action:"Ok"},{button:{text:"知道了"}}),o.props.onClose()},Se(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u["Component"]),Ne(t,[{key:"componentDidUpdate",value:function(e){if(!e.shown&&this.props.shown){var t=this.props,n=t.type,o=t.id;p.default.setModule(this.container,{module:"ReportDialog"},{card:{card_type:"Content",content:(r={type:Object(ke.a)(n)},a="comment"===n?"id":"token",i=String(o),a in r?Object.defineProperty(r,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[a]=i,r)}})}var r,a,i}},{key:"render",value:function(){var e=this,t=this.props,n=t.shown,o=t.onClose,r=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(t,["shown","onClose"]),a=this.state,i=a.title,s=a.subtitle,c=Object(we.a)(r,Object.keys(d.b.propTypes)),l=c.selectedProps,u=c.dropedProps;return m.a.createElement(d.b,Oe({title:i,subtitle:s,onClose:this.handleClose,className:"ReportModal"},l),n&&m.a.createElement(Ee,Oe({ref:function(t){e.container=t},onSubmit:this.handleSubmit,onEnd:o,onContentChange:this.handleContentChange},u)))}}]),t}(),ge.propTypes={onClose:l.a.func.isRequired,type:l.a.oneOf(Pe.a).isRequired,shown:l.a.bool.isRequired,isColumnArticle:l.a.bool,isTipjarEnabled:l.a.bool,onBlockUser:l.a.func,onDeleteComment:l.a.func,doReport:l.a.func.isRequired,zaEnabled:l.a.bool},ge.defaultTypes={zaEnabled:!1},Ce);n.d(t,"ReportModal",function(){return _e})},2356:function(e,t,n){"use strict";n.r(t);var o,r,a,i=n(0),s=n.n(i),c=n(1),l=n.n(c),u=n(6),m=n(2),p=n.n(m),d=n(493),f=n(2106),h=n(62),v=n(2179),y=n.n(v),b=n(2352),g=n(47),C=n(2146),E=n(29),w=n(315),k=n(21),P=n(17),O=n(5),N=n(77),S=n.n(N),I=n(20),R=n.n(I),_=n(3),j=n(500),T=n(54),x=n(204),L=n(67),D=n(142),A=n(143),M=n(2044),B=n(2036),F=n(64),q=n(13),z=n(8),V="zhihu::comment_local_key",U=5,W=(z.B,1e3),H=980,K=function(){return""},G={error:"上传失败",success:"上传成功",uploadIng:"上传中",default:""},Q=(n(2180),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),$=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function Z(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var J=Object(u.connect)(null,{showNotification:q.g,uploadImage:F.b})((a=r=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=Z(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={uploadStatus:G.default},o.triggerClick=function(e){var t=o.props.handleInputActive;o.uploadInput.click(),t(!0),e.preventDefault()},o.onError=function(){var e=o.props,t=e.showNotification,n=e.resetUploadImg;t("图片上传失败","red"),n()},o.onSuccess=function(){o.setState({uploadStatus:G.default})},o.resetFileInput=function(){o.uploadInput.value=null},o.beforeUpload=function(e){var t=o.props.showNotification;return e?e.size>1024*z.B*1024?(t("请上传小于 "+z.B+"M 的图片。","red"),o.resetFileInput(),!1):(o.reactPopoverNode.open(),void o.setState({uploadStatus:G.uploadIng})):(o.resetFileInput(),!1)},o.uploadImage=function(e){var t=e.file,n=o.props,r=n.uploadImage,a=n.handleImages,i=n.updatePublishStatus;return r(t).then(function(e){a([Q({},e.payload,{url:e.payload.src})]),i(!1),o.resetFileInput()}).catch(function(){o.setState({uploadStatus:G.error}),a([])})},o.handleOnRef=function(e){var t=o.props.onRef;t&&t(e),o.reactPopoverNode=e},Z(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),$(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.images,o=t.disableButton,r=t.resetUploadImg,a=this.state.uploadStatus,c=Boolean(n.length);return s.a.createElement(i.Fragment,null,s.a.createElement(L.a,{className:"ImagePopover",arrowed:!0,ref:this.handleOnRef,placement:"bottom",globalClose:!n.length,onClick:this.triggerClick,toggler:s.a.createElement(D.a,{label:"插入图片",icon:M.a,disabled:o})},s.a.createElement("div",{className:"ImagePopover-thumbnail"},c&&s.a.createElement(i.Fragment,null,s.a.createElement("img",{src:n[0].src}),s.a.createElement("div",{className:"closeButton",onClick:r},s.a.createElement(B.a,null))),a&&!c&&s.a.createElement("p",{className:"ImagePopover-uplodaStatus"},a))),s.a.createElement(A.a,{accept:"image/png,image/jpeg",onRef:function(t){e.uploadInput=t},beforeUpload:this.beforeUpload,customUpload:this.uploadImage,onSuccess:this.onSuccess,onError:this.onError}))}}]),t}(),r.propTypes={className:l.a.string,disableButton:l.a.bool},r.defaultProps={disableButton:!0},o=a))||o,Y=n(27),X=n(2045),ee=n(4),te=function(e){return s.a.createElement(ee.a,e,s.a.createElement("path",{d:"M16.375 3.018C19.701 4.643 22 8.047 22 12a9.944 9.944 0 0 1-1.349 5c-1.73 2.986-4.952 5-8.651 5-3.7 0-6.921-2.014-8.651-5A9.944 9.944 0 0 1 2 12c0-3.951 2.298-7.357 5.625-8.982A9.95 9.95 0 0 1 12 2c1.571 0 3.051.373 4.375 1.018zm-4.322 11.17c1.5 0 2.911.662 3.871 1.817a.6.6 0 0 1-.514.978.599.599 0 0 1-.406-.214 3.823 3.823 0 0 0-2.951-1.385c-.605 0-1.185.136-1.723.407a3.85 3.85 0 0 0-1.321 1.093c-.039.05-.091.081-.141.116H8.19c-.006-.004-.013-.003-.018-.006a.6.6 0 0 1-.11-.839 5.074 5.074 0 0 1 1.73-1.433 4.988 4.988 0 0 1 2.26-.534zM8.875 10.75a1.25 1.25 0 1 1 0-2.5 1.25 1.25 0 0 1 0 2.5zm6.25-2.5a1.25 1.25 0 1 1-.001 2.5 1.25 1.25 0 0 1 0-2.5zM19.17 17a8.695 8.695 0 0 0 1.58-5c0-3.23-1.764-6.05-4.375-7.566A8.698 8.698 0 0 0 12 3.25a8.69 8.69 0 0 0-4.375 1.184C5.014 5.95 3.25 8.77 3.25 12c0 1.859.586 3.581 1.579 5 1.583 2.264 4.205 3.75 7.171 3.75 2.965 0 5.586-1.486 7.17-3.75z",fillRule:"evenodd"}))};te.defaultProps={name:"Sad"};var ne,oe,re=te,ae=(n(2181),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var ie,se,ce=(oe=ne=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.state={isGifReady:!1,isGifError:!1},n.renderLoadStatus=function(){var e=n.state.isGifError;return s.a.createElement("div",{className:"CommentSticker-load"},e?s.a.createElement(s.a.Fragment,null,s.a.createElement(re,{className:"CommentSticker-load-Icons"}),"加载失败"):s.a.createElement(s.a.Fragment,null,s.a.createElement(X.a,{className:"CommentSticker-load-Icons"}),"加载中"))};var o=n.props.src;return Object(Y.loadImage)(Object(Y.imgUrl)(o)).then(function(){n.setState({isGifReady:!0})}).catch(function(){n.setState({isGifError:!0})}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.a.Component),ae(t,[{key:"render",value:function(){var e=this.state.isGifReady,t=this.props,n=t.src,o=t.handleStickerClick;return s.a.createElement("div",{className:"CommentSticker"},e?s.a.createElement("img",{src:n,className:"CommentSticker-img",onClick:o}):this.renderLoadStatus())}}]),t}(),ne.propsTypes={handleStickerClick:l.a.func},oe),le=(n(2182),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function ue(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var me,pe,de,fe,he,ve,ye=(se=ie=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=ue(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleOnRef=function(e){var t=o.props.onRef;t&&t(e)},ue(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),le(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.sticker,o=e.stickers,r=e.disableButton,a=e.handleStickerPopoverOpen,i=e.handleStickerPopoverClose,c=e.resetStickers,l=e.addSticker,u=e.handleEmotionClick;return s.a.createElement(L.a,{className:t,arrowed:!0,ref:this.handleOnRef,globalClose:!n.length,preventCloseOnTarget:!0,onClick:u,onOpen:a,onClose:i,toggler:s.a.createElement(D.a,{label:"插入表情",icon:X.a,disabled:r}),placement:"bottom"},Boolean(n.length)&&s.a.createElement("li",{className:"StickerPopover-stickers-item StickerPopover-stickers-item-single"},s.a.createElement("img",{src:Object(Y.imgUrl)(n[0].url),alt:n[0].title}),s.a.createElement("div",{className:"closeButton",onClick:c},s.a.createElement(B.a,null))),!n.length&&s.a.createElement("div",{className:"StickerPopover-stickers-wrap"},s.a.createElement("ul",{className:"StickerPopover-stickers-list"},o.map(function(e){var t=e.url,n=e.title,o=e.id;return s.a.createElement("li",{className:"StickerPopover-stickers-item",key:o},s.a.createElement(ce,{width:48,height:48,src:t,handleStickerClick:function(){return l(e)}}),s.a.createElement("p",null,n))}))))}}]),t}(),ie.propTypes={className:l.a.string,disableButton:l.a.bool},ie.defaultProps={disableButton:!0},se),be=(n(2183),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),ge=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Ce=(he=["回复","",""],ve=["回复","",""],Object.freeze(Object.defineProperties(he,{raw:{value:Object.freeze(ve)}})));function Ee(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var we=(me=Object(u.connect)(function(e){return{stickers:e.commentsV2.stickers||[],commentWithPicPermission:e.commentsV2.commentWithPicPermission||{}}},{showNotification:q.g}),Object(P.withRouter)(pe=me((fe=de=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=Ee(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={active:!1,disabled:!0,shown:!1,value:{toHTML:K},images:[],uploadIsFetchingNum:0,sticker:[],stickerIconActive:!1,toggleInputStyle:!1,commentTextLength:0},o.handleSubmit=o.context.authRequired(function(){var e=o.props,t=e.replyTo,n=e.onSubmit,r=e.onCancel,a=e.rootCommentId,i=e.isConversation,s=e.zaInfo.zaSubmitCommentId,c=o.state,l=c.images,u=c.sticker,m=o.input.toHTML();if(m||l.length||u.length){m&&o.saveLocalComment();var p=m;if(l.length||u.length){var d=l[0]||u[0];p+='<a class="'+(l[0]?l[0].url.includes(".gif")?"comment_gif":"comment_img":"comment_sticker")+"\" href='"+d.url+"' data-width='"+(d.dataRawwidth||"")+"' data-height='"+(d.dataRawheight||"")+"'>["+(d.title||"图片")+"]</a>"}var f=n(p,t,{rootCommentId:a,isConversation:i});f.then?f.then(function(){r&&r(),o.input?(o.input.reset(),o.resetImage(),o.setState({value:{toHTML:K}},function(){return o.saveLocalComment()})):o.saveLocalComment({toHTML:K})}):(r&&r(),o.input.reset()),O.default.trackEvent(o,be({action:"Comment",element:"Button"},s&&{id:s}))}},void 0,q.b),o.handleCommentShow=o.context.authRequired(function(){o.setState({shown:!0}),o.hiddenInput.focus()}),o.handleCommentHide=function(){o.setState({shown:!1})},o.initLocalComment=function(){var e=o.props,t=e.type,n=e.id;if(t&&n){var r=R.a.get(V)||[],a=t+"_"+n,i=r.find(function(e){return e.key===a}),s=i&&i.value;s&&o.setState({value:{toHTML:function(){return s}},disabled:!1})}},o.saveLocalComment=function(e){var t=o.props,n=t.type,r=t.id;if(n&&r){var a=e?e.toHTML():o.state.value.toHTML(),i=n+"_"+r,s=(R.a.get(V)||[]).filter(function(e){return e.key!==i}),c=a?[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(s.slice(0,U-1)),[{key:i,value:a}]):s;R.a.set(V,c)}},o.handleChange=function(e){var t=o.state,n=t.sticker,r=t.images;n.length||r.length?o.setState({value:e}):o.setState({value:e,disabled:e.isEmpty}),o.handleInputChange()},o.handleFocus=function(){o.setState({active:!0},o.handleInputChange)},o.handleBlur=function(){var e=o.state,t=e.sticker,n=e.images;t.length||n.length||(o.setState({active:!1}),o.handleInputChange())},o.handleMobileComment=function(){o.handleSubmit(),o.handleCommentHide()},o.handleEmotionClick=function(){var e=o.state.stickerIconActive;e&&o.setState({stickerIconActive:e},o.stickerPopover.close)},o.handleInputChange=function(){var e=Object(k.findDOMNode)(o.input);if(e){e.getBoundingClientRect().height>40?o.setState({toggleInputStyle:!0}):o.setState({toggleInputStyle:!1});var t=void 0;t="innerText"in document?e.innerText.length:e.textContent.length,o.setState({commentTextLength:t}),o.imgUploadPopover&&o.imgUploadPopover.position(),o.stickerPopover&&o.stickerPopover.position()}},o.handleStickerPopoverOpen=function(){o.setState({active:!0,stickerIconActive:!0},o.stickerPopover.position),setTimeout(o.stickerPopover.position,400)},o.handleStickerPopoverClose=function(){o.setState({stickerIconActive:!1})},o.handleImages=function(e){o.setState({images:e},o.imgUploadPopover.position)},o.handleInputActive=function(e){o.setState({active:e})},o.updatePublishStatus=function(e){o.setState({disabled:e})},o.resetStickers=function(){var e=o.state.value,t=void 0===e.isEmpty||e.isEmpty;o.stickerPopover&&o.stickerPopover.close(),o.setState({sticker:[],disabled:t})},o.resetImage=function(){o.resetStickers(),o.resetUploadImg()},o.resetUploadImg=function(){var e=o.state.value,t=void 0===e.isEmpty||e.isEmpty;o.imgUploadPopover&&o.imgUploadPopover.close(),o.setState({images:[],disabled:t})},o.addSticker=function(e){o.setState({sticker:[e],disabled:!1},o.stickerPopover.position)},o.focusInput=function(e){e.preventDefault(),o.input.focus()},o.createImageOnRef=function(e){o.imgUploadPopover=e},o.createStickerOnRef=function(e){o.stickerPopover=e},o.renderInput=function(e){var t=e.placeholder,n=e.className,r=o.props,a=r.autoFocus,i=r.stickers,c=r.commentWithPicPermission.commentWithPic,l=o.state,u=l.images,m=l.sticker,d=l.stickerIconActive,f=l.toggleInputStyle,h=l.active,v=l.disabled,y=l.commentTextLength,b=Boolean(m.length)||Boolean(u.length);return s.a.createElement("div",{className:p()("CommentEditorV2-inputWrap",{"CommentEditorV2-inputWrap--change":f,"CommentEditorV2-inputWrap--active":h||!v}),onClick:function(e){e.nativeEvent.stopImmediatePropagation()}},s.a.createElement(T.b,{keyMap:{FOCUS_COMMENT_INPUT:"shift+c"},handlers:{FOCUS_COMMENT_INPUT:o.focusInput}}),s.a.createElement(x.a,{className:p()("CommentEditorV2-input",n),defaultValue:o.state.value.toHTML(),richtext:!0,large:!0,spread:!0,allowMention:!0,allowPasteRichText:!1,autoFocus:a,outputBlockType:"div",onRef:function(e){o.input=e},placeholder:t,onFocus:o.handleFocus,onChange:o.handleChange,onSubmit:o.handleSubmit,minRows:5}),s.a.createElement("div",{className:p()("CommentEditorV2-inputUpload",{"CommentEditorV2-inputUpload--FlexEnd":f,"CommentEditorV2-inputUpload--SpaceBetween":f&&y>H})},f&&y>H&&s.a.createElement(j.a,{className:"CommentEditorV2-MaxLength",current:y,max:W}),s.a.createElement("div",{className:"CommentEditorV2-popoverWrap"},c&&s.a.createElement(J,{onRef:o.createImageOnRef,images:u,disableButton:b,resetUploadImg:o.resetUploadImg,handleInputActive:o.handleInputActive,updatePublishStatus:o.updatePublishStatus,handleImages:o.handleImages}),s.a.createElement(ye,{className:p()("CommentEditorV2-inputUpLoad-Icon",{"CommentEditorV2-inputUpLoad-Icon--active":d&&!m.length}),onRef:o.createStickerOnRef,disableButton:b,handleEmotionClick:o.handleEmotionClick,handleStickerPopoverOpen:o.handleStickerPopoverOpen,handleStickerPopoverClose:o.handleStickerPopoverClose,stickerIconActive:d,sticker:m,stickers:i,resetStickers:o.resetStickers,addSticker:o.addSticker}))))},Ee(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),ge(t,[{key:"componentDidMount",value:function(){this.initLocalComment(),document.addEventListener("click",this.handleBlur)}},{key:"componentWillUnmount",value:function(){this.saveLocalComment(),document.removeEventListener("click",this.handleBlur)}},{key:"render",value:function(){var e=this.props,t=e.replyTo,n=e.commentNeedsReview,o=e.className,r=e.ownerAuthorIsOrg,a=e.ownerAuthorIsBrand,i=this.state,c=i.active,l=i.disabled,u=r?"机构":"作者",m={preset:"primary",color:"blue",children:"发布",disabled:l};if(t&&t.author){var d=S()(Ce,t.author.member.name,n?"，评论由"+u+"筛选后公开":"");return s.a.createElement("div",{className:p()(o,"CommentEditorV2--normal",{"CommentEditorV2--active":c||!l})},this.renderInput({placeholder:d}),s.a.createElement(_.c,be({},m,{className:"CommentEditorV2-singleButton",onClick:this.handleSubmit})))}var f="写下你的评论...";return n&&(f=a?"已开启预审评论，评论由品牌筛选后公开":r?"已开启预审评论，评论由机构筛选后公开":"评论由作者筛选后显示"),s.a.createElement("div",{className:p()(o,"CommentEditorV2--normal",{"CommentEditorV2--active":c||!l})},this.renderInput({placeholder:f}),s.a.createElement(_.c,be({},m,{className:"CommentEditorV2-singleButton",onClick:this.handleSubmit})))}}]),t}(),de.propTypes={className:l.a.string,defaultActive:l.a.bool,replyTo:l.a.object,inCommentItem:l.a.bool,commentNeedsReview:l.a.bool,canComment:l.a.object,onCancel:l.a.func,onSubmit:l.a.func.isRequired,zaInfo:l.a.object},de.defaultProps={defaultActive:!1,replyTo:null,inCommentItem:!1,autoFocus:!0,ownerAuthorIsOrg:!1,ownerAuthorIsBrand:!1,zaInfo:{}},de.contextTypes={authRequired:l.a.func},pe=fe))||pe)||pe),ke=n(2110),Pe=n(494),Oe=n(38),Ne=n(828),Se=n(2028),Ie=n(826),Re=n(2031),_e=n(2032),je=n(829),Te=n(2033),xe=n(827),Le=n(2030),De=n(98),Ae=n(254),Me=n(96),Be=n(35),Fe=n(203),qe=n(95),ze=(n(2184),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function Ve(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function Ue(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var We,He,Ke,Ge,Qe=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=Ue(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={previewImg:null},o.handlePreview=function(e){var t=e.target,n=o.props.onPreviewImage;"function"==typeof n?n(e).catch(function(){o.setState({previewImg:t})}):o.setState({previewImg:t})},Ue(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),ze(t,[{key:"mount",value:function(){var e=this;this.imagesGifNode=this.root.getElementsByClassName("comment_gif"),this.imagesNode=this.root.getElementsByClassName("comment_img"),this.imagesStickerNode=this.root.getElementsByClassName("comment_sticker"),this.imgNode=this.root.getElementsByClassName("origin_image zh-lightbox-thumb"),this.imagesNodes=Array.from([].concat(Ve(this.imagesGifNode),Ve(this.imagesNode),Ve(this.imagesStickerNode),Ve(this.imgNode))).map(function(t){var n=t.dataset||{},o=n.width,r=n.height,a=n.rawwidth,i=n.rawheight,s=Number(o||a),c=Number(r||i),l=document.createElement("div");l.className="Richtext-content_img",t.parentNode.replaceChild(l,t);var u=t.getAttribute("href")||t.getAttribute("src"),m=new Image,p=t.getAttribute("class");return"comment_sticker"!==p&&l.addEventListener("click",e.handlePreview),m.className=p,m.src=u,m.dataset.original=Object(Y.imgUrl)(u,"r"),m.dataset.rawwidth=s,m.onload=function(){s===c||"comment_sticker"===p?l.classList.add("Richtext-content_img-square"):s>c?l.classList.add("Richtext-content_img-square--wideShape"):l.classList.add("Richtext-content_img-square--highShape"),l.appendChild(m)},l})}},{key:"unmount",value:function(){this.imagesNodes&&this.imagesNodes.forEach(function(e){Object(k.unmountComponentAtNode)(e)})}},{key:"componentDidMount",value:function(){this.mount()}},{key:"componentWillUpdate",value:function(e){this.props.html!==e.html&&this.unmount()}},{key:"componentDidUpdate",value:function(e){e.html!==this.props.html&&this.mount()}},{key:"componentWillUnmount",value:function(){this.unmount()}},{key:"render",value:function(){var e=this,t=this.state.previewImg,n=this.props,o=n.html,r=n.className;return s.a.createElement("div",{className:p()("CommentRichText",r),ref:function(t){return e.root=t}},s.a.createElement(qe.a,{html:o}),t&&s.a.createElement(Fe.a,{className:"CommentRichText-ImageView",img:t,onClose:function(){return e.setState({previewImg:null})}}))}}]),t}(),$e=n(71),Ze=n(334),Je=(n(2185),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),Ye=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function Xe(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var et,tt,nt=(We=Object(u.connect)(function(e){return{isWechat:e.env.userAgent.Wechat,permission:Object(De.c)(e)}}),Object(P.withRouter)(He=We((Ge=Ke=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=Xe(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={reportModalShown:!1,isReplying:!1,collapsed:!0,guideShown:!1,deleteModal:!1},o.toggleReply=o.context.authRequired(function(){o.setState({isReplying:!o.state.isReplying})},void 0,q.b),o.openReportModal=o.context.authRequired(function(){o.setState({reportModalShown:!0})}),o.like=o.context.authRequired(function(e){var t=o.props;(0,t.onLike)(t.comment.id,e)},z.E.like,q.b),o.dislike=o.context.authRequired(function(){var e=o.props;(0,e.onDislike)(e.comment.id)},z.E.like,q.b),o.delete=function(){var e=o.props;return(0,e.onDelete)(e.comment.id)},o.feature=function(e){var t=o.props,n=t.onFeature,r=t.comment.id;n(e?r+"_featured":r)},o.collapse=function(){var e=o.props;(0,e.onCollapse)(e.comment.id)},o.approve=function(){var e=o.props;(0,e.onApprove)(e.comment.id)},o.reject=function(){var e=o.props;(0,e.onReject)(e.comment.id)},o.showConversation=function(e){var t=o.props;(0,t.onShowConversation)({commentId:t.comment.id,isAnchorComments:e})},o.stopReply=function(){o.setState({isReplying:!1})},o.closeReportModal=function(e){if(e){var t=e.result.payload,n=t&&t.message||t&&t.code&&"举报失败";e.commentDeleteResult&&!(e.commentDeleteResult.payload||{}).code?Ae.b.showModal({reportText:n}):Object($e.b)(n||"举报成功")}o.setState({reportModalShown:!1})},o.handleToggleGuide=function(){o.setState({guideShown:!o.state.guideShown})},o.handleCloseDelete=function(){return o.setState({deleteModal:!1})},o.handleDelete=function(){return o.setState({deleteModal:!0})},Xe(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),Ye(t,[{key:"renderRoleInfo",value:function(e,t){return"normal"===e?null:s.a.createElement("span",{className:"CommentItemV2-roleInfo"},"ancestor"===e||"author"===e&&"question"===t?" (提问者) ":" (作者) ")}},{key:"renderReplyTo",value:function(){var e=this.props.comment,t=e.replyToAuthor,n=e.resourceType;if(!t)return null;var o=t.member,r=void 0===o?{}:o,a=t.role;return s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{className:"CommentItemV2-reply"},"回复"),s.a.createElement(Be.a,{noBadge:!0,noHoverCard:!0,user:r}),this.renderRoleInfo(a,n))}},{key:"renderItem",value:function(){var e=this,t=this.props,n=t.comment,o=n.isDelete,r=n.collapsed,a=t.isConversation,i=t.ownerAuthorIsOrg,c=r&&a&&this.state.collapsed,l=o||c,u=this.state,m=u.reportModalShown,d=u.isReplying,f=this.props,h=f.parent,v=h.canComment,y=(v=void 0===v?{status:!0}:v).status,b=h.questionType,g=f.commentNeedsReview,C=f.comment,E=f.onReply,w=f.status,k=f.type,P=f.canOperate,O=f.commentPattern,N=f.rootCommentId,S=f.byComment,I=f.isReverseAndStatusOpen,R=f.hasRecommend,j=f.permission.canBrandAdminEdit,T=C.id,x=C.author,L=C.content,D=C.voteCount,A=C.replyToAuthor,M=C.isAuthor,B=C.createdTime,F=C.featured,q=C.voting,z=C.reviewing,V=C.disliked,U=C.resourceType,W=C.childCommentCount,H=C.allowDelete,K=C.allowVote,G=C.canRecommend,Q=C.canCollapse,$=C.collapsedReason,Z=void 0===$?"":$,J=r&&a?"该评论已被折叠":L,Y=x||{},X=Y.member,ee=Y.role,te=Boolean(A),ne=F&&(W>0||te)&&!a||S&&te||I&&te,oe=void 0,re=M||H&&("question"!==k||"commercial"===b),ae=s.a.createElement("div",{className:"CommentItemV2-footer"},s.a.createElement(_.c,{className:p()("CommentItemV2-likeBtn",q&&"is-liked"),preset:"plain",onClick:this.like,disabled:M},s.a.createElement(Ne.a,{style:{marginRight:5},center:!0,size:16}),D>0?D:"赞"),r&&Z&&s.a.createElement("div",{className:"CommentItemV2-walleTag"},"阴阳怪气自动折叠"===Z&&s.a.createElement(Se.a,{size:16,className:"CommentItemV2-walleIcon"}),Z),ne&&s.a.createElement(_.c,{preset:"plain",className:"CommentItemV2-talkBtn",onClick:function(){return e.showConversation(te)}},s.a.createElement(Ie.a,{style:{marginRight:5},center:!0,size:16}),"查看回复"),!M&&y&&!r&&s.a.createElement(_.c,{preset:"plain",className:p()({"CommentItemV2-hoverBtn":!d}),onClick:this.toggleReply},s.a.createElement(Re.a,{style:{marginRight:5},center:!0,size:16}),d?"取消回复":"回复"),G&&!R&&P&&s.a.createElement(_.c,{className:p()({"CommentItemV2-hoverBtn":!M&&!d}),preset:"plain",onClick:function(){return e.feature(F)}},s.a.createElement(_e.a,{style:{marginRight:5},center:!0,size:16}),F?"取消推荐":"推荐"),Q&&!M&&s.a.createElement(_.c,{className:p()({"CommentItemV2-hoverBtn":!M&&!d}),preset:"plain",onClick:this.collapse},s.a.createElement(je.a,{style:{marginRight:5},center:!0,size:14}),r?"取消折叠":"折叠"),K&&!M&&P&&s.a.createElement(_.c,{className:p()({"CommentItemV2-hoverBtn":!d}),preset:"plain",onClick:this.dislike},s.a.createElement(Ne.a,{style:{transform:"rotate(180deg)",marginRight:5},size:16,center:!0}),V?"取消踩":"踩"),M||s.a.createElement(s.a.Fragment,null,s.a.createElement(_.c,{className:"CommentItemV2-hoverBtn",preset:"plain",onClick:this.openReportModal},s.a.createElement(Te.a,{style:{marginRight:5},center:!0,size:16}),"举报"),"question"===k&&"commercial"===b&&j&&s.a.createElement(_.c,{className:"CommentItemV2-hoverBtn",preset:"plain",onClick:this.reject},s.a.createElement(je.a,{style:{marginRight:5},center:!0,size:16}),"隐藏")),re&&s.a.createElement(_.c,{className:p()({"CommentItemV2-hoverBtn":!M&&!d&&!d}),preset:"plain",onClick:this.handleDelete},s.a.createElement(xe.a,{style:{marginRight:5},center:!0,size:16}),"删除"),s.a.createElement(Ae.a,{shown:this.state.deleteModal,id:T,onDelete:this.delete,onClose:this.handleCloseDelete}),s.a.createElement(Me.b,Je({type:"comment",urlToken:T,shown:m,onClose:this.closeReportModal},re&&{onDeleteComment:this.delete},{notification:{failure:Ze.a},zaEnabled:!0})));return oe=d?s.a.createElement("div",null,ae,s.a.createElement(we,{type:"comment",id:T,commentNeedsReview:g,className:"CommentItemV2-editor",defaultActive:!0,replyTo:C,onCancel:this.stopReply,onSubmit:E,rootCommentId:N,isConversation:a})):"reviewing"===w?s.a.createElement("div",{className:"CommentItemV2-footer"},s.a.createElement(_.c,{preset:"plain",onClick:this.approve},s.a.createElement(Le.a,{style:{marginRight:5},center:!0,size:14}),"公开"),s.a.createElement(_.c,{className:"CommentItemV2-hoverBtn",preset:"plain",onClick:this.handleDelete},s.a.createElement(xe.a,{style:{marginRight:5},center:!0,size:16}),"删除"),s.a.createElement(Ae.a,{shown:this.state.deleteModal,id:T,onDelete:this.delete,onClose:this.handleCloseDelete})):ae,s.a.createElement("div",null,s.a.createElement("div",{className:"CommentItemV2-meta"},X&&s.a.createElement(Be.a,{className:"CommentItemV2-avatar",avatar:!0,noHoverCard:"fixed"===O,user:X}),X&&s.a.createElement(Be.a,{noBadge:!0,noHoverCard:!0,user:X}),this.renderRoleInfo(ee,U),this.renderReplyTo(),z&&s.a.createElement(je.a,{className:"CommentItemV2-reviewing","data-tooltip":!1===i?"评论未公开，由作者筛选后显示":"已开启预审评论，评论由机构筛选后公开",center:!0,size:14}),s.a.createElement("span",{className:"CommentItemV2-time"},Object(Oe.toRelativeString)(B))),s.a.createElement("div",{className:"CommentItemV2-metaSibling"},s.a.createElement(Qe,{className:p()("CommentItemV2-content",{"CommentItemV2-shield":l}),html:J}),!l&&oe))}},{key:"render",value:function(){return this.renderItem()&&s.a.createElement("div",{className:"CommentItemV2",ref:this.props.onRef},this.renderItem())}}]),t}(),Ke.propTypes={comment:l.a.object.isRequired,parent:l.a.object.isRequired,commentNeedsReview:l.a.bool,type:l.a.string,isConversation:l.a.bool,onLike:l.a.func.isRequired,onShowConversation:l.a.func,onReply:l.a.func,onFeature:l.a.func,onDelete:l.a.func.isRequired,onCollapse:l.a.func,commentPattern:l.a.string},Ke.contextTypes={currentUser:l.a.object,authRequired:l.a.func},He=Ge))||He)||He),ot=(n(2186),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function rt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var at,it=5,st=2,ct=(tt=et=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=rt(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={},o.handleClick=function(){var e,t,n,r=o.props,a=r.loadRestComments,i=r.onShowConversation,s=r.comment,c=s.id,l=s.childCommentCount,u=l<=it&&l>st;(u?a:i)({commentId:c}),u&&o.setState((n=!0,(t="hide_"+c)in(e={})?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e))},o.handleRef=function(e){var t=o.props.onRef;"function"==typeof t&&t(e)},rt(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),ot(t,[{key:"render",value:function(){var e=this.props,t=e.comment,n=t.id,o=t.childCommentCount,r=e.isFetching,a=e.className,i=this.state["hide_"+n],c=o<=it&&o>st?"展开其他 "+(o-st)+" 条回复":"查看全部 "+o+" 条回复";return s.a.createElement("div",{className:a,ref:this.handleRef},!i&&s.a.createElement("div",{className:"CommentMoreReplyButton"},s.a.createElement(_.c,{preset:"plain",onClick:this.handleClick},c)),r&&s.a.createElement(g.a,{className:"CommentMoreReplyButton",small:!0}))}}]),t}(),et.propTypes={comment:l.a.object.isRequired,isFetching:l.a.bool,onShowConversation:l.a.func,loadRestComments:l.a.func},tt),lt=(n(2187),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());function ut(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var mt=Object(u.connect)(null,{loadConversation:d.g})(at=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=ut(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.loadRestComments=function(e){var t=e.commentId;(0,o.props.loadConversation)({id:t,isLoadRest:!0})},ut(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),lt(t,[{key:"render",value:function(){var e=this.props,t=e.parent,n=t.type,o=t.author,r=(o=void 0===o?{isOrg:!1}:o).isOrg,a=e.parent,c=e.commentNeedsReview,l=e.onShowConversation,u=e.status,m=e.onItemLike,d=e.onItemDelete,f=e.onItemCollapse,h=e.onItemDislike,v=e.onItemApprove,y=e.onItemReject,b=e.canOperateItem,g=e.commentPattern,C=e.conversation,E=void 0===C?{}:C,w=e.entities,k=e.byComment,P=e.isReverseAndStatusOpen,O=e.comment,N=e.onReply,S=e.onFeature,I=e.ids,R=O.id,_=O.featured,j=O.childComments,T=void 0===j?[]:j,x=O.childCommentCount,L=void 0===x?0:x,D=_?R+"_featured":""+R,A=!_&&I.includes(R+"_featured"),M=Boolean(T.length)&&!P,B=L<=5&&L>2,F=T.map(function(e){return w.comments[e]}),q=!_&&L>2&&!P,z=(B&&E[R]||{isFetching:!1}).isFetching;return s.a.createElement(i.Fragment,null,s.a.createElement("li",{className:p()({"NestComment--rootCommentNoChild":!M,"NestComment--rootComment":M}),key:D},s.a.createElement(nt,{key:D,comment:O,status:u,type:n,parent:a,canOperate:b,commentNeedsReview:c,onShowConversation:l,ownerAuthorIsOrg:r,onLike:m,onReply:N,onFeature:S,onDelete:d,onCollapse:f,onDislike:h,onApprove:v,onReject:y,commentPattern:g,rootCommentId:R,byComment:k,isReverseAndStatusOpen:P,hasRecommend:A})),M&&F.map(function(e){var t=e.id,o=e.featured,i=o?t+"_featured":""+t,p=!o&&I.includes(t+"_featured");return s.a.createElement("li",{className:"NestComment--child",key:i},s.a.createElement(nt,{key:i,comment:e,status:u,type:n,parent:a,canOperate:b,commentNeedsReview:c,onShowConversation:l,ownerAuthorIsOrg:r,onLike:m,onReply:N,onFeature:S,onDelete:d,onCollapse:f,onDislike:h,onApprove:v,onReject:y,commentPattern:g,rootCommentId:R,hasRecommend:p}))}),q&&s.a.createElement(ct,{comment:O,isFetching:z,onShowConversation:l,loadRestComments:this.loadRestComments}))}}]),t}())||at,pt=n(52),dt=n(92),ft=n(16);function ht(e){var t=e.id,n=e.replyTo,o=e.isConversation;if(e.isNotification)return{type:"notification"};if(o)return{type:"conversation"};if(!n)return{type:"comment"};var r=n.featured,a=n.replyToAuthor,i=n.id;return t===i&&r?a?{type:"replyToSubFeatured"}:{type:"replyToFeatured"}:t!==i||a?t!==i&&a?{type:"replyToSubCommon"}:{type:"comment"}:{type:"replyToCommon"}}n(2188);var vt,yt,bt,gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Ct=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function Et(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var wt=Object(u.connect)(function(e,t){var n=t.parent,o=t.parent,r=o.type,a=o.id,i=t.status,s=t.order,c=t.byComment,l=t.commentPattern,u=t.notificationId,m=e.entities,p=e.commentsV2,d=e.commentsV2,f=d.conversation,h=d.stickers,v=void 0===h?[]:h,b=d.commentWithPicPermission,g=d.notificationsComments,C=r+"_"+a,E=p.parent,w=m.comments[c],k=p.pagination;"reviewing"===i&&(k=p.reviewing);var P="reverse"===s&&"open"===i;P&&(k=p.reverse);var O=[],N=p.collapsed[C]||{};N.ids&&N.ids.length>0&&(O=N.ids.map(function(e){return m.comments[e]}));u&&(k=g,C=u);var S=k[C]||{isPrevDrained:!1,isFetching:!1,isDrained:!1,ids:[]},I=S.isFetching,R=S.isPrevDrained,_=S.isDrained,j=S.ids,T=S.newIds,x=void 0===T?[]:T,L=S.totals,D="bottom"!==l?j:x,A=D.map(function(e){return m.comments[e]}),M=y()(D,function(e){return String(e).includes("_featured")});return{currentUser:Object(ft.c)(e),isFetching:I,isPrevDrained:R,isDrained:_,totals:u?A.length:L,collapsedInfo:N,collapsedComments:O,targetComment:w,conversation:f,entities:m,stickers:v,lastFeaturedIndex:M,comments:A,isReverseAndStatusOpen:P,commentWithPicPermission:b,ids:D,parent:gt({},n,E[C]),permission:Object(De.c)(e)}},{loadComments:d.f,loadConversation:d.g,addComment:d.a,loadStickers:d.j,clearNotification:q.d,getCommentWithPicPermission:d.e,loadNotificationComments:d.i,loadAnswerCommentPermission:pt.c,loadArticleCommentPermission:dt.b})((bt=yt=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=Et(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={collapsed:!0,current:1,packupButtonStatus:!1,packupButtonLeft:0},o.load=function(e,t,n){if(!o.props.isFetching&&!o.props.parent.adminClosedComment){var r=e||o.props,a=r.order,i=r.status,s=r.parent,c=s.id,l=s.type,u=r.commentPattern,m=r.needLoadCommentPermission,p=r.loadComments,d=r.notificationId,f=r.loadNotificationComments;if(d)return f(d);if(m&&o.loadCommentPermission(l,c),n){p(l,c,{order:a,isPrevious:t,status:"collapsed",commentPattern:u},!0)}else p(l,c,{order:a,isPrevious:t,status:i,commentPattern:u})}},o.addComment=function(e,t,n){var r=n.rootCommentId,a=n.isConversation,i=o.props,s=i.parent,c=s.id,l=s.type,u=i.commentId,m=i.addComment,p=i.notificationId;return m({parentType:l,parentId:c,content:e,replyTo:t,conversationId:u,rootCommentId:r,isConversation:a,notificationId:p,replyType:ht({id:r,replyTo:t,isConversation:a,isNotification:Boolean(p)}).type})},o.featureItem=function(e){(0,o.props.onItemFeature)(e,o.lastFeaturedIndex)},o.handleOpenCollapsed=function(){o.setState({collapsed:!1}),o.load(o.props,!1,!0)},o.handleScroll=function(){if(o.commentsElement&&o.commentsWithPaginationEl){var e=window.innerHeight,t=o.state.packupButtonStatus,n=o.commentsWithPaginationEl.getBoundingClientRect(),r=n.top,a=n.bottom,i=n.height;!t&&i>500&&a>e&&r<0?o.setState({packupButtonStatus:!0}):t&&(i<=500||a<=e||r>=0)&&o.setState({packupButtonStatus:!1})}},o.handlePageSelect=function(e){var t=o.props.onPaginationClick,n=o.state.current;t&&t(n,e),o.commentsElement.scrollIntoView(),o.setState({current:e}),o.loadByPagination(e)},o.loadByPagination=function(e,t){var n=t||o.props,r=n.order,a=n.status,i=n.parent,s=i.id,c=i.type,l=n.commentPattern,u=n.needLoadCommentPermission,m=n.loadComments;u&&o.loadCommentPermission(c,s),m(c,s,{order:r,isPrevious:!1,status:a,commentPattern:l,current:e})},o.renderComment=function(e){var t=e.id,n=e.featured?t+"_featured":t;return s.a.createElement("ul",{className:"NestComment",key:n},s.a.createElement(mt,gt({comment:e,onReply:o.addComment,onFeature:o.featureItem},o.props)))},o.renderNormalComments=function(e){var t=o.state.collapsed,n=o.props,r=n.byComment,a=n.lastFeaturedIndex,i=n.parent,c=i.featuredCounts,l=i.commonCounts,u=[],m=c>0;return o.lastFeaturedIndex=0,e.length>0&&e.forEach(function(n,i){if(r||!n.collapsed){var p=e[i-1];n.collapsed&&(p&&p.collapsed||u.push(o.renderCollapsedDivider()),t)||(i===a&&u.push(s.a.createElement("div",{className:"NestComment-nextSiblings--noBorder",key:"NestComment-nextSiblings--noBorder"})),m&&0===i&&-1!==a&&u.push(s.a.createElement("div",{className:"CommentListV2-header-divider",key:"divider-featured"},"精选评论（",c,"）")),u.push(o.renderComment(n)),i===a&&(o.lastFeaturedIndex=i,u.push(s.a.createElement("div",{className:"CommentListV2-header-divider",key:"divider-comment"},"评论（",l,"）"))))}}),u},o.renderCollapsedComments=function(){var e=[],t=o.props,n=t.collapsedComments,r=t.isDrained,a=t.parent,i=(a=void 0===a?{}:a).collapsedCounts;return!r||i<=0?[]:(e.push(n.map(function(e){return o.renderComment(e)})),e)},o.renderComments=function(e){return e.map(o.renderComment)},o.renderCollapsedDivider=function(){var e=o.props,t=e.isDrained,n=e.parent.collapsedCounts;return!t||n<=0?[]:o.state.collapsed?s.a.createElement("div",{className:"CommentListV2-action",key:"collapsed"},s.a.createElement("div",{className:"CommentListV2-expendCollapseButton"},s.a.createElement("span",{onClick:o.handleOpenCollapsed},Object(E.formatNumber)(n)," 条评论被折叠"),"（",s.a.createElement("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）")):s.a.createElement("div",{className:"CommentListV2-divider",key:"divider-collapsed"},s.a.createElement("div",{className:"CommentListV2-dividerLine"}),s.a.createElement("div",{className:"CommentListV2-dividerText"},Object(E.formatNumber)(n)," 条评论被折叠（",s.a.createElement("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）"))},o.renderCollapsedInfiLoader=function(){var e=o.state.collapsed;if(e)return[];var t=o.props.collapsedInfo,n=(t=void 0===t?{}:t).isFetching,r=t.isPrevDrained,a=t.isDrained;return s.a.createElement(g.b,{className:"CommentListV2",onRef:function(e){o.listEl=e},isLocal:!0,isLoading:n,isPrevDrained:r,isDrained:a,onLoad:function(t){return o.load(o.props,t,!e)},placeholder:s.a.createElement(g.a,{className:"CommentItem",small:!0})},o.renderCollapsedComments())},o.renderPatternContent=function(e){var t=o.props,n=t.isFetching,r=t.parent.adminClosedComment,a=t.byComment,i=t.status,c=t.order,l=t.totals,u=t.showPackupButton,m=t.handlePackupButton,p=Math.ceil(l/20),d=o.state,h=d.current,v=d.packupButtonStatus,y=d.packupButtonLeft;return r?null:n?s.a.createElement(ke.a,{onRef:function(e){o.commentsWithPaginationEl=e}}):s.a.createElement("div",{ref:function(e){o.commentsWithPaginationEl=e}},s.a.createElement("div",{className:"CommentListV2"},"normal"===c&&"open"===i?o.renderNormalComments(e):o.renderComments(e)),p>1&&s.a.createElement(C.a,{className:"CommentsV2-pagination",current:h,total:p,onSelect:o.handlePageSelect}),!a&&o.renderCollapsedDivider(),!a&&o.renderCollapsedInfiLoader(),s.a.createElement(f.CSSTransitionGroup,{transitionName:"CommentsV2-Packup-Button",transitionEnterTimeout:300,transitionLeaveTimeout:300},u&&v&&s.a.createElement("button",{onClick:m,className:"CommentsV2-Packup-Button",style:{left:y}},"收起评论",s.a.createElement(b.a,{center:!0}))))},o.renderModalContent=function(e){var t=o.props,n=t.collapsedInfo,r=t.parent.adminClosedComment,a=t.status,i=t.order,c=t.byComment,l=o.state.collapsed,u=l?o.props:n,m=u.isFetching,p=u.isDrained,d=u.isPrevDrained;if(p&&e.length<=0||r)return s.a.createElement("div",{className:"CommentsV2-empty"},s.a.createElement(w.a,{entityType:"comments"}));return s.a.createElement(g.b,gt({className:"CommentListV2",onRef:function(e){o.listEl=e},isLocal:!0,isLoading:m,isPrevDrained:d,isDrained:p,onLoad:function(e){return o.load(o.props,e,!l)},placeholder:s.a.createElement(g.a,{className:"CommentItemV2",small:!0})},{getContainer:function(e){return e}}),"normal"===i&&"open"===a?o.renderNormalComments(e):o.renderComments(e),!c&&o.renderCollapsedDivider(),!c&&o.renderCollapsedComments())},o.renderCommentEdit=function(){var e=o.props,t=e.parent,n=t.canComment,r=(n=void 0===n?{status:!0}:n).status,a=n.reason,i=t.author,c=(i=void 0===i?{isOrg:!1}:i).isOrg,l=t.type,u=t.id,m=t.adminClosedComment,d=t.questionType,f=e.byComment,h=e.autoFocus,v=e.commentNeedsReview,y=e.zaInfo,b=m?"当前内容暂时无法评论":a,g=h&&!f;return r&&!m?s.a.createElement(we,{className:"CommentsV2-footer",type:l,id:u,commentNeedsReview:v,onSubmit:o.addComment,autoFocus:g,ownerAuthorIsOrg:c,ownerAuthorIsBrand:"commercial"===d,zaInfo:y}):s.a.createElement("div",{className:p()("CommentsV2-disabledText")},s.a.createElement("div",{className:"CommentsV2-disabledReason"},b))},Et(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),Ct(t,[{key:"loadCommentPermission",value:function(e,t){var n=this.props,o=n.loadAnswerCommentPermission,r=n.loadArticleCommentPermission;switch(e){case"answer":return o(t);case"article":return r(t);default:return null}}},{key:"componentDidMount",value:function(){this.subscription=Object(h.subscribe)("scroll",this.handleScroll);var e=this.props,t=e.commentPattern,n=e.parent.adminClosedComment,o=e.stickers,r=e.loadStickers,a=e.getCommentWithPicPermission,i=e.commentWithPicPermission,s=e.currentUser,c=this.state.current;"bottom"!==t||n||(this.loadByPagination(c),this.commentsWithPaginationEl&&this.setState({packupButtonLeft:this.commentsWithPaginationEl.getBoundingClientRect().right-16})),!o.length&&r(),void 0===i.commentWithPic&&s&&a()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.order,o=t.status,r=t.targetComment,a=t.commentPattern;n===e.order&&o===e.status||("bottom"===a?(this.setState({current:1}),this.loadByPagination(1,e)):this.load(e),this.setState({collapsed:!0}));var i=e.targetComment;!r&&i&&this.setState({collapsed:!i.collapsed})}},{key:"componentWillUnmount",value:function(){Object(q.d)(q.b),this.subscription&&this.subscription.unsubscribe()}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,o=t.comments,r=t.commentPattern,a=t.commentInputPosition,i=t.isAuthor,c=t.parent,l=c.author,u=(l=void 0===l?{isOrg:!1}:l).isOrg,m=c.commentPermission,d=c.reviewingCounts,f=c.commentCount,h=c.adminClosedComment,v=t.totals,y=t.status,b=t.order,g=t.onStatusChange,C=t.onOrderChange,E=t.targetLink,w=t.shouldReverse,k=t.permission.canBrandAdminEdit,P="censor"===m&&(i||k),O=P?{isCommentReviewer:P,onStatusChange:g,status:y,reviewingCounts:d}:{status:y};return s.a.createElement("div",{className:p()("CommentsV2 CommentsV2--withEditor",{"CommentsV2-withPagination":"bottom"===r},n),ref:function(t){e.commentsElement=t}},s.a.createElement(Pe.a,gt({commentCount:void 0!==f?f:v,shouldReverse:w,commentClosed:h,targetLink:E,order:b,onOrderChange:C,commentPattern:r,isOrg:u},O)),"top"===a&&this.renderCommentEdit(),"bottom"===r?this.renderPatternContent(o):this.renderModalContent(o),"bottom"===a&&this.renderCommentEdit())}}]),t}(),yt.propTypes={type:l.a.string,parent:l.a.object.isRequired,targetLink:l.a.node,commentNeedsReview:l.a.bool,byComment:l.a.oneOfType([l.a.number,l.a.string]),commentPattern:l.a.string,commentInputPosition:l.a.oneOf(["top","bottom"]),showPackupButton:l.a.bool,handlePackupButton:l.a.func,onPaginationClick:l.a.func,autoFocus:l.a.bool,shouldReverse:l.a.bool},yt.contextTypes={authRequired:l.a.func.isRequired},yt.defaultProps={commentInputPosition:"bottom",showPackupButton:!0,autoFocus:!0,shouldReverse:!0},vt=bt))||vt;var kt,Pt,Ot,Nt=n(115),St=n.n(Nt),It=n(157),Rt=n.n(It),_t=n(23),jt=n(2056),Tt=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function xt(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function Lt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Dt=Object(u.connect)(function(e,t){var n=t.conversationId,o=t.isAnchorComments,r=e.entities.comments,a=e.commentsV2,i=a.conversation,s=a.conversationMore,c=i[n]||{isFetching:!1,isDrained:!1,isPrevDrained:!1,ids:[]},l=c.isFetching,u=c.isDrained,m=c.isPrevDrained,p=c.ids,d=c.totals,f=c.topComments,h=(f=void 0===f?{}:f).paging,v=(h||{}).isEnd,y=s[n]||{isFetching:!1,isDrained:!1,ids:[]},b=y.isFetching,g=y.isDrained,C=y.ids,E=C.map(function(e){return r[e]}),w=p.map(function(e){return r[e]}),k=r[n+"_featured"]||r[n]||{},P=o?Rt()(C.length?[].concat(xt(w.slice(0,4)),xt(E),xt(w.slice(4))):w,"id"):[k].concat(xt(w)),O=h?[].concat(xt(w.slice(0,3)),xt(E)).length:-1;return{isFetching:l,isDrained:u,isPrevDrained:m,totals:d,comments:P,openComment:k,topCommentsPaging:h,isConversationMoreFetching:b,isConversationMoreDrained:v||g,offsetIndex:O}},{loadConversation:d.g,addComment:d.a,loadMoreAnchorComments:d.h})((Ot=Pt=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=Lt(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.load=function(){var e=o.props,t=e.isAnchorComments,n=e.conversationId;(0,e.loadConversation)({id:n,isAnchorComments:t})},o.addComment=function(e,t,n){var r=n.rootCommentId,a=n.isConversation,i=o.props,s=i.parent,c=s.type,l=s.id,u=i.conversationId,m=i.addComment,p=i.isAnchorComments;return m({parentType:c,parentId:l,content:e,replyTo:t,conversationId:u,rootCommentId:r,isConversation:a,replyType:ht({id:r,replyTo:t,isConversation:a}).type,isAnchorComments:p})},o.loadMoreAnchorComments=function(){var e=o.props,t=e.conversationId,n=e.topCommentsPaging,r=void 0===n?{}:n;(0,e.loadMoreAnchorComments)({conversationId:t,nextUrl:r.next})},o.createOnRef=St()(function(e){return function(t){var n=o.props.byComment;parseInt(e)===Number(n)&&(o.targetCommentEl=t)}}),o.scrollToTarget=function(){var e=o,t=e.targetCommentEl,n=e.listEl;if(n&&t){var r=t.getBoundingClientRect(),a=r.top,i=r.height,s=n.getBoundingClientRect(),c=s.top,l=s.height;o.listEl.scrollTop+=a-c-(l-i)/2,t.classList.add("CommentItemV2--highlighted"),setTimeout(function(){return t.classList.remove("CommentItemV2--highlighted")},2e3),t.tabIndex=-1,t.focus()}},Lt(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),Tt(t,[{key:"componentDidMount",value:function(){this.props.byComment&&this.scrollToTarget()}},{key:"componentDidUpdate",value:function(e){!e.comments.length&&this.props.comments.length&&this.props.byComment&&this.scrollToTarget()}},{key:"render",value:function(){var e=this,t=this.props,n=t.onItemLike,o=t.onItemDelete,r=t.onItemFeature,a=t.onItemApprove,c=t.onItemCollapse,l=t.onItemDislike,u=t.onNavBack,m=t.canOperateItem,p=t.isFetching,d=t.comments,f=void 0===d?[]:d,h=t.commentNeedsReview,v=t.openComment.collapsed,y=t.parent,b=t.commentPattern,C=t.totals,E=t.isDrained,w=t.isPrevDrained,k=t.isConversationMoreFetching,P=t.isConversationMoreDrained,O=t.offsetIndex,N=null;return p&&!f.length?N=s.a.createElement(i.Fragment,null,s.a.createElement(g.a,{className:"CommentItemV2",small:!0}),s.a.createElement("div",{className:"CommentsV2-openComment-divider"}),s.a.createElement("div",{className:"CommentsV2-replyNum"},C+" 条回复")):f.length&&(N=f.map(function(t,u){return u?P||u!==O||k?k&&u===O?s.a.createElement(i.Fragment,{key:t.id},s.a.createElement(nt,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:h,canOperate:m,parent:y,comment:t,onLike:n,onDelete:o,onFeature:r,onApprove:a,onCollapse:c,onDislike:l,collapsedShown:v,onReply:e.addComment}),s.a.createElement(g.a,{key:"NestCoomment-moreCommentButton-PlaceHolder",className:"NestCoomment-moreCommentButton ",small:!0})):s.a.createElement(nt,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:h,canOperate:m,parent:y,comment:t,onLike:n,onDelete:o,onFeature:r,onApprove:a,onCollapse:c,onDislike:l,collapsedShown:v,onReply:e.addComment}):s.a.createElement(i.Fragment,{key:t.id},s.a.createElement(nt,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:h,canOperate:m,parent:y,comment:t,onLike:n,onDelete:o,onFeature:r,onApprove:a,onCollapse:c,onDislike:l,collapsedShown:v,onReply:e.addComment}),s.a.createElement("div",{key:"NestCoomment-moreCommentButton",preset:"plain",className:"NestCoomment-moreCommentButton",onClick:e.loadMoreAnchorComments},s.a.createElement(jt.a,null),s.a.createElement("p",null,"点击查看更多回复"))):s.a.createElement(i.Fragment,{key:t.id},s.a.createElement("div",{className:"CommentsV2-openComment"},s.a.createElement(nt,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:h,canOperate:m,parent:y,comment:t,onLike:n,onDelete:o,onFeature:r,onApprove:a,onCollapse:c,onDislike:l,collapsedShown:v,onReply:e.addComment})),s.a.createElement("div",{className:"CommentsV2-openComment-divider"}),s.a.createElement("div",{key:t.id+"-title"},s.a.createElement("div",{className:"CommentsV2-replyNum"},C+" 条回复")))})),"bottom"===b?s.a.createElement(_t.b,{size:"fullPage",onClose:u},s.a.createElement("div",{className:"CommentsV2"},s.a.createElement(Pe.a,{isConversation:!0,commentPattern:b}),s.a.createElement(g.b,{className:"CommentListV2",onRef:function(t){e.listEl=t},isLocal:!0,isLoading:p,isDrained:E,isPrevDrained:w,onLoad:this.load,placeholder:s.a.createElement(g.a,{className:"CommentItemV2",small:!0}),getContainer:function(e){return e}},N))):s.a.createElement("div",{className:"CommentsV2"},s.a.createElement(Pe.a,{isConversation:!0,onNavBack:u}),s.a.createElement(g.b,{className:"CommentListV2",onRef:function(t){e.listEl=t},isLocal:!0,isLoading:p,isDrained:E,isPrevDrained:w,onLoad:this.load,placeholder:s.a.createElement(g.a,{className:"CommentItemV2",small:!0}),getContainer:function(e){return e}},N))}}]),t}(),Pt.propTypes={conversationId:l.a.number.isRequired,type:l.a.string,parent:l.a.object.isRequired,commentNeedsReview:l.a.bool},Pt.contextTypes={currentUser:l.a.object,authRequired:l.a.func.isRequired},kt=Ot))||kt;var At=n(48);n.d(t,"default",function(){return Ut});var Mt,Bt,Ft,qt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},zt=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function Vt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Ut=Object(u.connect)(null,{updateCommentLikeStatus:d.o,updateCommentFeatureStatus:d.n,deleteComment:d.d,updateCommentCollapsed:d.l,updateCommentDisliked:d.m,approveComment:d.b,rejectComment:d.k})(Mt=Object(At.a)(null)((Ft=Bt=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=Vt(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.state={openedCommentId:null,isAnchorComments:!1,status:"open",order:"normal"},o.showConversation=function(e){var t=e.commentId,n=e.isAnchorComments;o.setState({openedCommentId:t,isAnchorComments:n})},o.showComments=function(){o.setState({openedCommentId:null,isAnchorComments:!1})},o.delete=function(e){var t=o.props,n=t.parent;return(0,t.deleteComment)(e,n.type,n.id)},o.feature=function(e){var t=o.props,n=t.parent,r=t.updateCommentFeatureStatus,a=t.notificationId;r({id:o.state.openedCommentId,commentId:e,parentId:n.id,parentType:n.type,notificationId:a})},o.like=function(e,t){var n=o.props,r=n.onItemLike,a=n.updateCommentLikeStatus;r&&r(e,t),a(e)},o.collapse=function(e){var t=o.props,n=t.parent;(0,t.updateCommentCollapsed)(e,n.type,n.id)},o.dislike=function(e){(0,o.props.updateCommentDisliked)(e)},o.approve=function(e){var t=o.props,n=t.parent,r=t.type;(0,t.approveComment)(e,n.type||r,n.id)},o.reject=function(e){var t=o.props,n=t.parent,r=t.type;(0,t.rejectComment)(e,n.type||r,n.id)},o.handleStatusChange=function(e){o.setState({status:e})},o.handleOrderChange=function(e,t){var n=o.props.onOrderChange;n&&n(e,t),o.setState({order:e})},Vt(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),zt(t,[{key:"componentDidMount",value:function(){var e=this.props.onMount;e&&e(this.commentsContainerNode)}},{key:"render",value:function(){var e=this,t=this.props,n=t.parent,o=t.commentPattern,r=t.type,a=t.parent,i=(a=void 0===a?{}:a).commentPermission,c=a.relationship,l=void 0===c?{}:c,u=a.author,m=void 0===u?{}:u,d=t.needLoadCommentPermission,f=t.byComment,h=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(t,["parent","commentPattern","type","parent","needLoadCommentPermission","byComment"]),v=this.context.currentUser,y=void 0===l.isAuthor?v&&m.urlToken&&v.urlToken===m.urlToken:l.isAuthor,b="censor"===i&&!y,g="answer"===r||"article"===r,C=this.state,E=C.openedCommentId,w=C.status,k=C.order,P=C.isAnchorComments,O=P&&(E||f)||f;return s.a.createElement("div",{className:"Comments-container",ref:function(t){return e.commentsContainerNode=t}},s.a.createElement(wt,qt({className:p()({"CommentsV2--hidden":E&&"bottom"!==o})},h,{type:r,order:k,status:w,parent:n,commentPattern:o,commentNeedsReview:b,canOperateItem:g,onShowConversation:this.showConversation,onItemLike:this.like,onItemFeature:this.feature,onItemDelete:this.delete,onItemCollapse:this.collapse,onItemDislike:this.dislike,onItemApprove:this.approve,onItemReject:this.reject,byComment:O,onStatusChange:this.handleStatusChange,onOrderChange:this.handleOrderChange,needLoadCommentPermission:d,isAuthor:y})),E&&s.a.createElement(Dt,qt({},h,{parent:n,type:r,canOperateItem:g,onItemLike:this.like,onItemFeature:this.feature,onItemDelete:this.delete,onItemCollapse:this.collapse,onItemDislike:this.dislike,onItemApprove:this.approve,onItemReject:this.reject,commentPattern:o,conversationId:E,onNavBack:this.showComments,byComment:O,isAnchorComments:P,commentNeedsReview:b,onShowConversation:this.showConversation})))}}]),t}(),Bt.propTypes={type:l.a.string.isRequired,parent:l.a.object.isRequired,onOrderChange:l.a.func,onItemLike:l.a.func,isAuthor:l.a.bool,onMount:l.a.func},Bt.defaultProps={type:"answer"},Bt.contextTypes={currentUser:l.a.object,authRequired:l.a.func.isRequired},Mt=Ft))||Mt)||Mt},2358:function(e,t,n){"use strict";n.r(t);var o,r,a=n(1),i=n.n(a),s=n(0),c=n.n(s),l=n(3),u=(n(329),n(32)),m=n(5),p=n(23),d=n(46),f=n(500),h=function(e,t,n){return n&&void 0!==t&&(e||!t)},v=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var y=20,b=60,g=(r=o=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.shouldSubmitIsDisabled=function(){var t=e.state,n=t.title,o=t.description;return!n||n.length>y||o.length>b},e.state={isPublic:!0,title:"",description:""},e.handleSubmit=e.handleSubmit.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),v(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state,n=t.isPublic,o=t.title,r=t.description;if(o){var a=this.props,i=a.onSubmit,s=a.onBack,c=a.authRequired,l=a.isActive,u={title:o,description:r,isPublic:n};h(n,l,c)?c(i)(u):(i(u),s())}}},{key:"render",value:function(){var e=this,t=this.state,n=t.title,o=t.description,r=t.isPublic,a=this.props.onBack,i=this.shouldSubmitIsDisabled();return c.a.createElement("form",{className:"Favlists-content",onSubmit:this.handleSubmit},c.a.createElement("div",{className:"Favlists-addItems"},c.a.createElement("div",{className:"Favlists-addItem"},c.a.createElement(d.a,{className:"Favlists-titleInput",placeholder:"收藏标题",onChange:function(t){var n=t.target.value;e.setState({title:n})}}),c.a.createElement("div",{className:"Favlists-inputTips"},c.a.createElement(f.a,{name:"收藏标题",current:n?n.length:0,max:y}))),c.a.createElement("div",{className:"Favlists-addItem"},c.a.createElement(d.a,{multiline:!0,className:"Favlists-descritionInput",placeholder:"收藏描述（可选）",onChange:function(t){var n=t.target.value;e.setState({description:n})},rows:5}),c.a.createElement("div",{className:"Favlists-inputTips"},c.a.createElement(f.a,{name:"收藏描述",current:o?o.length:0,max:b}))),c.a.createElement("div",{className:"Favlists-addItem"},c.a.createElement("label",{className:"Favlists-privacyOption"},c.a.createElement("input",{className:"Favlists-privacyOptionRadio",name:"isPublic",type:"radio",value:"true",checked:r,onChange:function(){return e.setState({isPublic:!0})}}),c.a.createElement("span",null,"公开"),c.a.createElement("span",{className:"Favlists-privacyOptionTips"},"有其他人关注此收藏夹时不可设置为私密")),c.a.createElement("label",{className:"Favlists-privacyOption"},c.a.createElement("input",{className:"Favlists-privacyOptionRadio",name:"isPublic",type:"radio",value:"false",checked:!r,onChange:function(){return e.setState({isPublic:!1})}}),c.a.createElement("span",null,"私密"),c.a.createElement("span",{className:"Favlists-privacyOptionTips"},"只有你自己可以查看这个收藏夹")))),c.a.createElement(u.a,{direction:"horizontal",className:""},a&&c.a.createElement(l.c,{onClick:a},"返回"),c.a.createElement(l.c,{color:"blue",preset:"primary",type:"submit",disabled:i},"确认创建")))}}]),t}(),o.propTypes={onSubmit:i.a.func.isRequired,onBack:i.a.func,authRequired:i.a.func},r),C=n(47),E=n(137),w=n(4),k=function(e){return c.a.createElement(w.a,e,c.a.createElement("path",{d:"M18 8c.1-3.308-2.592-6-5.9-6-3.308 0-6 2.692-6 6v2H5.002C4 10 4 11 4 11v9s0 2 2 2h12c2 0 2-1.97 2-1.97V11s0-1-1-1h-1V8zm-6-4c2.143.018 4.005 1.597 4 4v2H8V7.996C8.013 5.562 9.857 3.982 12 4z",fillRule:"evenodd"}))};k.defaultProps={name:"Lock"};var P=k,O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},N=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var I,R,_=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=S(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleChange=function(){var e=o.props;(0,e.onChange)(e.id,o.props.checked)},S(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),N(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.zaEnabled,n=e.id;t&&m.default.setModule(this,{module:"CollectionItem"},{card:{card_type:"Content",content:{type:"Collection",token:String(n)}}})}},{key:"render",value:function(){var e=this.props,t=e.answerCount,n=e.title,o=e.isPublic,r=e.checked,a=void 0!==r&&r?{preset:"primary",color:"grey",children:"已收藏"}:{color:"blue",children:"收藏"};return c.a.createElement("div",{className:"Favlists-item"},c.a.createElement("div",{className:"Favlists-itemInner"},c.a.createElement("div",{className:"Favlists-itemName"},c.a.createElement("span",{className:"Favlists-itemNameText"},n),!1===o&&c.a.createElement("span",{className:"Favlists-itemIcon"},c.a.createElement(P,{size:16}))),c.a.createElement("div",{className:"Favlists-itemContent"},t," 条内容")),c.a.createElement(l.c,O({},a,{className:"Favlists-updateButton",onClick:this.handleChange})))}}]),t}(),j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},T=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function x(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var L,D,A,M=(R=I=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=x(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.items={},o.handleFavlistItemChange=function(e,t){m.default.trackEvent(o.items[e],{action:t?"UnCollect":"Collect",element:"Button",is_intent:!1}),o.props.onUpdate(e,t)},x(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),T(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.relations,o=t.items,r=t.isFetching,a=t.isDrained,i=t.onAdd,s=t.onLoad;return c.a.createElement("div",{className:"Favlists-content"},c.a.createElement(C.b,{isLocal:!0,isLoading:r,isDrained:a,onLoad:s,placeholder:c.a.createElement(E.a,{title:!0}),getContainer:function(e){return e},className:"Favlists-items"},o.map(function(t){return c.a.createElement(_,j({key:t.id,onChange:e.handleFavlistItemChange,checked:n[t.id]},t,{ref:function(n){e.items[t.id]=n}}))})),!o.length&&r||c.a.createElement("div",{className:"Favlists-actions"},c.a.createElement(l.c,{className:"Favlists-addButton",onClick:i,preset:"primary",color:"blue"},"创建收藏夹")))}}]),t}(),I.propTypes={isFecthing:i.a.bool,relations:i.a.object,onUpdate:i.a.func.isRequired,onAdd:i.a.func.isRequired,onLoad:i.a.func.isRequired,items:i.a.array.isRequired,isDrained:i.a.bool,authRequired:i.a.func},R),B=n(2111),F=n(2112),q=(n(2189),n(2190),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),z=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function V(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var U={list:{title:"添加收藏",tips:function(e){return e?"请选择你想添加的收藏夹":"你可以创建多个收藏夹，将答案分类收藏"}},add:{title:"创建新收藏夹"}},W=(D=L=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=o=V(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),A.call(o),V(o,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),z(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.shown,o=t.items,r=t.id,a=t.type,i=t.onFetchRelations,s=e.items,c=e.relations;if(i&&(s.length!==o.length&&e.shown||s.length&&!n&&e.shown)){var l=(c?s.filter(function(e){return!{}.hasOwnProperty.call(c,e.id)}):s).map(function(e){return e.id});l.length&&i(r,a,l)}s.length>o.length&&this.setState({status:"list"})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.id,o=t.type,r=t.shown,a=t.zaEnabled;r&&!e.shown&&this.container&&a&&m.default.setModule(this.container,{module:"CollectionDialogue"},{card:{card_type:"Content",content:{type:Object(F.a)(o),token:String(n)}}})}},{key:"render",value:function(){var e=this,t=this.state.status,n=U[t],o=n.title,r=n.tips,a=this.props,i=a.shown,s=a.defaultStatus,m=a.relations,d=a.onFavlistAdd,f=a.onLoad,h=a.isFetching,v=a.isDrained,y=a.items,b=a.zaEnabled,C=a.authRequired,E=a.isUserActive,w=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(a,["shown","defaultStatus","relations","onFavlistAdd","onLoad","isFetching","isDrained","items","zaEnabled","authRequired","isUserActive"]),k=!(v&&!y.length),P=Object(B.a)(w,Object.keys(p.b.propTypes)).selectedProps,O=void 0;return O="list"===t?k?c.a.createElement(M,{ref:function(t){e.container=t},items:y,isFetching:h,isDrained:v,relations:m,onAdd:this.handleAdd,onUpdate:this.handleUpdate,onLoad:f,zaEnabled:b}):c.a.createElement(u.a,null,c.a.createElement(l.c,{preset:"primary",color:"blue",onClick:this.handleAdd},"创建收藏夹"),c.a.createElement(l.c,{onClick:this.handleCloseModal},"取消")):c.a.createElement(g,{onSubmit:d,isActive:E,onBack:"add"===s?this.handleCloseModal:this.handleBack,authRequired:C}),c.a.createElement(p.b,q({},P,{onClose:this.handleCloseModal,title:o,subtitle:r&&r(k),buttonGroupOnly:!k,className:"FavlistsModal",size:"large"}),i&&O)}}]),t}(),L.propTypes={id:i.a.oneOfType([i.a.string,i.a.number]),type:i.a.oneOf(["answer","article","pin"]),relations:i.a.object,onUpdateFav:i.a.func.isRequired,onFavlistAdd:i.a.func.isRequired,onFetchRelations:i.a.func,onClose:i.a.func.isRequired,shown:i.a.bool,zaEnabled:i.a.bool,authRequired:i.a.func,isUserActive:i.a.number},L.defaultProps={defaultStatus:"list",relations:{},authRequired:function(e){return e}},A=function(){var e=this;this.state={status:this.props.defaultStatus},this.handleCloseModal=function(){e.props.onClose&&e.props.onClose(),e.setState({status:"list"})},this.handleUpdate=function(t,n){var o=e.props,r=o.onUpdateFav,a=o.id,i=o.type,s=o.items,c=o.authRequired,l=o.isUserActive,u=s.find(function(e){return e.id===t})||{},m=[t,a,i,u.isPublic];return!n&&h(u.isPublic,l,c)?c(r).apply(void 0,m):r.apply(void 0,m)},this.handleAdd=function(){return e.setState({status:"add"})},this.handleBack=function(){return e.setState({status:"list"})}},D);n.d(t,"FavlistsModal",function(){return W})},2360:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(1),i=n.n(a),s=n(2),c=n.n(s),l=n(3),u=n(32),m=n(768),p=n(69),d=n(34),f=(n(2347),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var h=8,v=9,y=13,b=48,g=57;function C(e,t){return e?t?!0===t?"":t:e:""}var E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onInputFocus=n.onInputFocus.bind(n),n.onInputChange=n.onInputChange.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),f(t,[{key:"onInputFocus",value:function(){this.props.onFocus()}},{key:"onInputChange",value:function(e){var t=String(e.target.value);if(t){t=t[t.length-1];var n=this.props.chars,o=this.props.length;n.length===o?n=n.replace(/.$/,t):n+=t,this.props.onChange(n),n.length===o&&this.props.onFinish(n)}}},{key:"onKeyDown",value:function(e){var t=e.keyCode;if(!e.metaKey&&!e.ctrlKey&&t!==v&&t!==y){var n=this.props.chars;t===h?(n=n.slice(0,-1),this.props.onChange(n)):(t<b||t>g)&&(e.preventDefault(),this.props.onError(e))}}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var e=this,t=this.props,n=t.length,o=t.chars,a=t.maskChar,i=t.autoFocus,s=t.className,l=t.children,u=o.length===n?n-1:o.length,m=o[u]||"";return r.a.createElement("label",{className:c()("TPass",s)},r.a.createElement("span",{className:"TPass-wrapper"},r.a.createElement(w,{length:n,chars:o,maskChar:a}),r.a.createElement("input",{className:"TPass-input",value:m,style:{left:60*u},onFocus:this.onInputFocus,onChange:this.onInputChange,onKeyDown:this.onKeyDown,onPaste:function(e){return e.preventDefault()},type:"number",min:"0",max:"9",pattern:"[0-9]*",autoFocus:i,ref:function(t){e.input=t}})),l)}}]),t}();function w(e){for(var t,n=e.length,o=e.chars,a=e.maskChar,i=[],s=0;s<n;s+=1)t=o[s],i.push(r.a.createElement("span",{className:c()("TPassBox",{"TPassBox-mask":t&&Boolean(a)}),key:s},C(t,a)));return r.a.createElement("span",{className:"TPassBoxes"},i)}E.defaultProps={length:6,chars:"",maskChar:!1,autoFocus:!1,onFocus:function(){},onChange:function(){},onError:function(){},onFinish:function(){}},E.propTypes={length:i.a.number,chars:i.a.string,maskChar:i.a.oneOfType([i.a.bool,i.a.string]),autoFocus:i.a.bool,onFocus:i.a.func,onChange:i.a.func,onError:i.a.func,onFinish:i.a.func,className:i.a.string,children:i.a.node};var k,P,O=E,N=(n(2348),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}());var S=(P=k=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),N(t,[{key:"render",value:function(){var e=this.props;return r.a.createElement("div",{className:c()("Spinner",e)},r.a.createElement("i",{className:"Spinner-loading"}))}}]),t}(),k.propTypes={className:i.a.string},P),I=n(108),R=(n(2349),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var T=11;function x(){this.payments={},this.chosePaymentName=null,this.codeUrl="",this.qrLoaded=!1,this.need=null,this.passcode="",this.needSMS=!1,this.smsTimer=0,this.isInProgress=!1,this.error=null}var L=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onPasscodeFocus=function(){n.state.error&&(n.setState({error:null}),6===n.state.passcode.length&&n.setState({passcode:""}))},n.onPasscodeInput=function(e){"object"===(void 0===e?"undefined":_(e))&&(e=e.target.value),n.setState({passcode:e})},n.onPasscodeFinish=function(e){n.tpass.blur(),n.payWithBalance(e)},n.onSendSMSCode=function(){n.props.trade.resendSMSCode(function(){n.startSMSTimer(),n.smsInput.focus()},function(e){n.setState({error:e})})},n.onQrLoad=function(){n.setState({qrLoaded:!0})},n.onBalanceFormSubmit=function(e){e.preventDefault(),n.payWithBalance(n.state.passcode)},n.setPayments=function(e){n.setState({payments:e})},n.confirmPayment=function(){var e=n.state,t=e.choseName,o=e.payments,r=n.props.onConfirmPayment,a=t;if(t||(a=o.balance&&o.balance.enable?"balance":"wechat"),r(!a),n.setState({chosePaymentName:a}),"wechat"===a&&n.isInWechat){var i=n.props.tradeNumber,s=location.protocol+"//"+location.host+location.pathname,c="https://www.zhihu.com/pay/weixin/pay?service_id="+T+"&trade_number="+i+"&redirect_uri="+encodeURIComponent(s);window.location.replace(c)}else n.props.trade["wechat"===a?"initWechatPay":"initBalancePay"]()},n.pid=0,n.smsTimer=null,n.state=new x,n.isInWechat=e.ua.Wechat,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),j(t,[{key:"componentWillMount",value:function(){var e=this.props.trade;this.getPaymentsList(e),this.initListeners(e)}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.trade!==this.props.trade&&(this.setState(new x),setTimeout(function(){t.getPaymentsList(e.trade)},300),this.initListeners(e.trade))}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.smsTimer),this.props.trade.dispose()}},{key:"getPaymentsList",value:function(e){var t=this;if(e){var n=this.pid+=1;e.getPaymentsList(function(e){t.pid===n&&t.setPayments(e)})}}},{key:"initListeners",value:function(e){var t=this;e&&e.on("payInited",function(e,n){t.setState(R({},n))}).on("paySuccess",function(){t.setState({isInProgress:!1,error:null}),t.props.onSuccess()}).on("payCancel",function(){t.setState({isInProgress:!1,chosePaymentName:null})}).on("payFail",function(e){var n=e;"object"!==(void 0===e?"undefined":_(e))||e instanceof Error||(n=e.message),t.setState({isInProgress:!1,error:n}),t.props.onFail(e)}).on("needSMS",function(e){t.setState({isInProgress:!1,error:null,needSMS:e.message,passcode:""})}).on("needWechatCode",function(){t.props.onError("needWechatCode")}).on("error",function(e,n){t.props.onError(e,n)})}},{key:"startSMSTimer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;window.clearInterval(this.smsTimer),this.setState({smsTimer:t}),this.smsTimer=window.setInterval(function(){(t-=1)<=0?(window.clearInterval(e.smsTimer),e.smsTimer=null,e.setState({smsTimer:0})):e.setState({smsTimer:t})},1e3)}},{key:"payWithBalance",value:function(e){return 6!==e.length?(this.setState({error:"请输入 6 位支付密码"}),!1):(this.setState({isInProgress:!0,error:null}),this.props.trade.payWithBalance(e))}},{key:"renderPaymentsList",value:function(){var e=this,t=this.state,n=t.payments,o=t.chosePaymentName,a=t.choseName,i=this.props.trade;if(o)return null;var s=n.balance&&n.balance.amount,c=i.info.total,u=n.wechat&&n.wechat.enable,m=n.balance&&n.balance.enable,f=n.balance&&!n.balance.enable,h=s>=c?"使用余额（剩余 "+(s/100).toFixed(2)+"）":"微信支付",v=s>=c?"wallet":"wechatPayment",y="PaymentItem-"+(s>=c?"wallet":"wechatPayment");a&&(h="wechat"===a?"微信支付":"使用余额（剩余 "+(s/100).toFixed(2)+"）",v="wechat"===a?"wechatPayment":"wallet",y="PaymentItem-"+("wechat"===a?"wechatPayment":"wallet"));var b=r.a.createElement("div",null,r.a.createElement(d.a,{name:v,className:y}),r.a.createElement(l.c,{className:"Payment-Popover"},h),r.a.createElement(d.a,{className:"Select-arrow",name:"select"}));return r.a.createElement("div",{className:"PaymentsList"},r.a.createElement("span",{className:"Payment-Topline"}),r.a.createElement("span",{className:"PaymentWay"},"支付方式"),r.a.createElement(I.a,{placeholder:b},r.a.createElement(p.b,{plain:!0,className:"Payment-select",listClassName:"Payment-select-list",targetClassName:"Popover-targetContainer-verification",text:s>=c?"使用余额（剩余 "+(s/100).toFixed(2)+"）":"微信支付",menuToggler:b,onChange:function(t){"disabled"!==t&&e.setState({choseName:t})}},m&&r.a.createElement(p.a,{value:"balance",className:"PaymentItem"},r.a.createElement(d.a,{name:"wallet",className:"PaymentItem-wallet"}),"使用余额（剩余 "+(s/100).toFixed(2)+"）"),f&&r.a.createElement(p.a,{value:"disabled",className:"PaymentItem PaymentItem--disabled"},r.a.createElement(d.a,{name:"wallet",className:"PaymentItem-wallet"}),"使用余额（剩余 "+(s/100).toFixed(2)+"）"),u&&r.a.createElement(p.a,{value:"wechat",className:"PaymentItem"},r.a.createElement(d.a,{name:"wechatPayment",className:"PaymentItem-wechatPayment"}),"微信支付"))),r.a.createElement("span",{className:"Payment-Bottomline"}),r.a.createElement(l.c,{className:"Payment-CheckedButton",onClick:this.confirmPayment},"确认支付"))}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,o=t.trade,a=this.state,i=a.payments,s=a.chosePaymentName,u=a.codeUrl,m=a.needSMS,p=a.isInProgress;return o?r.a.createElement("div",{className:c()("Payment",n)},Object.keys(i).length?this.renderPaymentsList():r.a.createElement("div",{className:"Payment-placeholder"},r.a.createElement(S,null)),"wechat"===s&&r.a.createElement("div",{className:"Payment-wechatPay"},r.a.createElement("div",{className:"Payment-wechatPayTitle"},r.a.createElement("i",{className:"icon icon-ic_wechatpay PaymentIconWechat"}),"微信支付"),!this.isInWechat&&r.a.createElement("div",null,"使用微信扫描二维码完成支付"),this.state.qrLoaded?r.a.createElement("span",{className:"Payment-qrWrapper"},r.a.createElement("img",{role:"presentation",src:"//www.zhihu.com/qrcode?url="+u,width:"150",height:"150"})):r.a.createElement("div",{className:"Payment-qrPlaceholder"},r.a.createElement(S,null),!this.isInWechat&&r.a.createElement("div",null,"正在生成二维码"),u&&r.a.createElement("img",{role:"presentation",src:"//www.zhihu.com/qrcode?url="+u,width:"1",height:"1",onLoad:this.onQrLoad}))),"balance"===s&&r.a.createElement("form",{onSubmit:this.onBalanceFormSubmit,className:"Payment-balancePay"},r.a.createElement("div",{className:"Payment-balancePayTitle"},r.a.createElement("i",{className:"icon icon-wallet PaymentIconWallet"}),"余额支付"),!m&&r.a.createElement("div",null,r.a.createElement("div",{className:"Payment-description"},"请输入 6 位数知乎支付密码，用于支付验证。"),r.a.createElement(O,{chars:this.state.passcode,onFocus:this.onPasscodeFocus,onChange:this.onPasscodeInput,maskChar:!0,onFinish:this.onPasscodeFinish,className:c()("Payment-tpass",{"Payment-errorInput":this.state.error,"Payment-progressing":p}),autoFocus:!0,ref:function(t){e.tpass=t}},p&&r.a.createElement(S,{className:"Payment-balancePaySpinner"}))),Boolean(m)&&r.a.createElement("div",{className:"Payment-balancePaySms"},r.a.createElement("div",{className:"Payment-balancePaySmsText"},String(m)),r.a.createElement("input",{onChange:this.onPasscodeInput,value:this.state.passcode,className:c()("Payment-sms","SimpleInput",{"Payment-errorInput":this.state.error}),type:"text",pattern:"\\d{6}",minLength:"6",maxLength:"6",title:"验证码应为 6 位数字",placeholder:"输入 6 位数验证码",required:!0,autoFocus:!0,ref:function(t){e.smsInput=t}}),this.state.smsTimer?r.a.createElement("button",{className:"Payment-sendSms",type:"button",disabled:!0},this.state.smsTimer," 秒后可重发"):r.a.createElement("button",{onClick:this.onSendSMSCode,className:"Payment-sendSms",type:"button"},"发送验证码")),r.a.createElement("div",{className:"Payment-balancePayFooter"},r.a.createElement("p",{className:"Payment-errorTip",style:{visibility:this.state.error?"visible":"hidden"}},this.state.error),Boolean(m)&&r.a.createElement(l.c,{color:"blue",disabled:p,className:"Payment-balancePayConfirmBtn",type:"submit"},"确认")),!m&&r.a.createElement("div",{className:"Payment-balancePayForget"},"如果忘记密码请邮件联系"," ",r.a.createElement("email",{className:"Payment-email"},"i@zhihu.com")))):r.a.createElement("div",{className:c()("Payment",n)},r.a.createElement("div",{className:"Payment-placeholder Payment-placehoder--empty"},r.a.createElement(S,null)))}}]),t}();L.propTypes={trade:i.a.object,autoChooseSinglePayment:i.a.bool,onSuccess:i.a.func.isRequired,onFail:i.a.func,onError:i.a.func,onConfirmPayment:i.a.func},L.defaultProps={trade:null,onSuccess:function(){},onFail:function(){},onError:function(){},autoChooseSinglePayment:!0,className:""};var D=L,A=n(195),M="",B=null;var F=n(8);n(2350);n.d(t,"TipjarDialog",function(){return H});var q,z,V=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var U=[200,500,1e3,5e3,1e4,2e4],W=100,H=(z=q=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.lockScroll=function(){document.body.classList.add("scroll-locked"),n.scrollTop=window.scrollY,document.body.style.width="100%",document.body.style.position="fixed",document.body.style.top=-n.scrollTop+"px"},n.unlockScroll=function(){document.body.classList.remove("scroll-locked"),document.body.style.width=null,document.body.style.position=null,void 0!==n.scrollTop&&(window.scrollTo(0,n.scrollTop),n.scrollTop=void 0),document.body.style.top=null},n.onConfirmPayment=function(e){n.setState({chosePaymentName:e})},n.onPaySuccess=function(){n.props.onPaySuccess(),n.setState({chosePaymentName:!0,colseTijarDialogStatus:!0,trade:void 0,currentAmount:"",customButton:!1})},n.handleCustomAmount=function(){n.state.trade&&n.state.trade.dispose(),n.setState({showCustom:!0})},n.handleCustomChange=function(e){var t=e.target.value;isNaN(t)?n.setState({customAmount:""}):n.setState({customAmount:parseInt(t)||""})},n.handleCustomKeyUp=function(e){13===e.keyCode&&n.handleSubmitCustom()},n.handleSubmitCustom=function(){var e=n.state.customAmount*W;e>0&&e<=5e4&&(n.setState({customButton:!0,showCustom:!1,colseTijarDialogStatus:!1}),n.createTrade(e))},n.closeModal=function(){n.state.trade&&n.state.trade.dispose(),n.setState(n.getDefaultState())},n.handleAmountButton=function(e){n.createTrade(e.currentTarget.dataset.amount),n.setState({colseTijarDialogStatus:!1,customButton:!1,showCustom:!1})},n.createTrade=function(e){n.setState({tradeLoading:!0,currentAmount:e});var t=n.props.ua;n.props.addReward(e,t.Wechat?"wechat":"normal"),n.setState({tradeLoading:!1})},n.colseTijarDialog=function(){n.setState({chosePaymentName:!0,colseTijarDialogStatus:!0,trade:void 0,currentAmount:""}),n.props.colseTijarDialog()},n.state=n.getDefaultState(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),V(t,[{key:"componentDidMount",value:function(){this.showTip()}},{key:"componentDidUpdate",value:function(e){var t=e.TipjarRender,n=this.props,o=n.tradeNumber,r=n.type,a=n.isMobile,i=n.TipjarRender,s=this.state,c=s.trade,l=s.colseTijarDialogStatus,u="article"===r?11:17;if(o&&(!c||o!==c.tradeNo)&&!l){var m=new window.zhihu.pay.Trade(o,u);this.setState({trade:m})}a&&(!t&&i?this.lockScroll():t&&!i&&this.unlockScroll())}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.TipjarRender,n=e.isMobile;t&&this.props.removeTradeNumber(),t&&n&&this.unlockScroll()}},{key:"getDefaultState",value:function(){return{showCustom:!1,customAmount:"",currentAmount:"",showTipModal:!1,customButton:!1,chosePaymentName:!0,colseTijarDialogStatus:!1}}},{key:"showTip",value:function(){var e,t,n=this;e="https://pay.zhihu.com/api/js",t=function(){n.setState({showTipModal:!0})},M&&e&&e!==M&&t(new Error("A pay-sdk from different source has been load")),M=e,window.zhihu&&window.zhihu.pay?window.zhihu.pay.ready(t):(B||(B=Object(A.loadScript)(e)),B.then(function(){return window.zhihu.pay.ready(t)},function(e){t(e),B=null}))}},{key:"renderAmountCustom",value:function(){var e=this.state,t=e.showCustom,n=e.customAmount,o=e.currentAmount,a=e.customButton;return r.a.createElement("div",{className:"Reward-TipjarDialog-amountCustom"},t?r.a.createElement("div",{className:"Reward-TipjarDialog-amountInput"},r.a.createElement("input",{name:"",type:"text",className:"SimpleInput",placeholder:"你想赞赏的金额（不超过 500）",value:n,onChange:this.handleCustomChange,onKeyUp:this.handleCustomKeyUp,ref:function(e){e&&e.focus()}}),r.a.createElement(l.c,{disabled:n<=0||n>500,color:"blue",preset:"primary",onClick:this.handleSubmitCustom},"确定"),r.a.createElement("div",{className:"Reward-TipjarDialog-error",style:{display:n>500?"block":"none"}},"不能超过 500 元")):r.a.createElement(l.c,{preset:"plain",className:a?"TipjarDialog-customButton-cheked":"TipjarDialog-customButton",onClick:this.handleCustomAmount},a?"自定义金额： ￥ "+o/W:"自定义金额"))}},{key:"renderTipjarDialog",value:function(){var e=this,t=this.props,n=t.author,o=n.name,a=n.avatarUrl,i=n.isOrg,s=n.urlToken,u=n.id,m=t.tagline,p=this.state.currentAmount;return r.a.createElement("div",{className:"Reward-TipjarDialog"},r.a.createElement("div",{className:"Reward-TipjarDialog-user"},r.a.createElement("a",{href:"/"+(i?"org":"people")+"/"+(s||u),className:"Reward-UserAvatar"},r.a.createElement("img",{src:a.replace("_is","_l"),className:"Reward-Avatar",alt:"当前用户"})),o),r.a.createElement("div",{className:"Reward-TipjarDialog-tagLine"},m),r.a.createElement("div",{className:"Reward-TipjarDialog-selectAmount"},r.a.createElement("div",{className:"Reward-TipjarDialog-amountList"},U.map(function(t){return r.a.createElement(l.c,{key:t,"data-amount":t,onClick:e.handleAmountButton,color:"red",className:c()({"Reward-Button-checked":Number(p)===t})},r.a.createElement("b",null,Number(p)===t?t/W+" 元":"￥ "+t/W))})),this.renderAmountCustom()))}},{key:"render",value:function(){var e=this.props,t=e.ua,n=e.TipjarRender,o=e.isMobile,a=e.tradeNumber,i=this.state,s=i.showCustom,c=i.tradeLoading,l=i.showTipModal,p=i.trade,d=i.chosePaymentName,f=o?m.a:u.b,h=o?"small":"default";return r.a.createElement(f,{overlay:!0,size:h,onClose:this.colseTijarDialog,className:"Reward-TipjarDialogModal"},n&&r.a.createElement("div",null,l&&d&&this.renderTipjarDialog(),(p||c)&&!s&&r.a.createElement(D,{trade:p,tradeNumber:a,ua:t,onSuccess:this.onPaySuccess,onConfirmPayment:this.onConfirmPayment})))}}]),t}(),q.propTypes={author:i.a.object,tagline:i.a.string,colseTijarDialog:i.a.func,addReward:i.a.func,tradeNumber:i.a.number,removeTradeNumber:i.a.func,onPaySuccess:i.a.func,isMobile:i.a.bool,type:i.a.string},q.defaultProps={tagline:F.i},z)},2361:function(e,t,n){"use strict";n.r(t);var o,r,a=n(1),i=n.n(a),s=n(0),c=n.n(s),l=n(6),u=n(2),m=n.n(u),p=n(91),d=n(2106),f=n(5),h=n(62),v=n(115),y=n.n(v),b=n(2058),g=n(2352),C=n(90),E=n(47),w=n(2146),k=n(3),P=n(29),O=n(117),N=n(13),S=n(52),I=n(92),R=n(315),_=n(502),j=n(501),T=n(2110),x=n(494),L=(n(2178),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}()),D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};function A(e,t){switch(e){case"answer":return Object(S.c)(t);case"article":return Object(I.b)(t);default:return null}}var M,B,F=(r=o=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.state={collapsed:!0,current:1,packupButtonStatus:!1,packupButtonLeft:0},o.handleOpenCollapsed=function(){o.setState({collapsed:!1}),o.load(o.props,!1,!0)},o.createOnRef=y()(function(e){return function(t){var n=o.props.byComment;e===Number(n)&&(o.targetCommentEl=t)}}),o.handlePageSelect=function(e){var t=o.props.onPaginationClick,n=o.state.current;t&&t(n,e),o.commentsElement.scrollIntoView(),o.setState({current:e}),o.loadByPagination(e)},o.renderComment=function(e){var t=o.props,n=t.parent,r=n.type,a=n.author,i=(a=void 0===a?{isOrg:!1}:a).isOrg,s=t.isMobile,l=t.parent,u=t.commentNeedsReview,m=t.onShowConversation,p=t.status,d=t.onItemLike,f=t.onItemDelete,h=t.onItemCollapse,v=t.onItemDislike,y=t.onItemApprove,b=t.canOperateItem,g=t.commentPattern;return c.a.createElement(j.a,{key:e.id,isMobile:s,comment:e,onRef:o.createOnRef(e.id),status:p,type:r,parent:l,canOperate:b,commentNeedsReview:u,onShowConversation:m,ownerAuthorIsOrg:i,onLike:d,onReply:o.addComment,onFeature:o.featureItem,onDelete:f,onCollapse:h,onDislike:v,onApprove:y,commentPattern:g})},o.renderNormalComments=function(e){var t=o.state.collapsed,n=o.props.byComment,r=[];if(o.lastFeaturedIndex=0,e.length>0){var a=e[0].featured,i=!1;e.forEach(function(s,l){if(n||!s.collapsed){var u=e[l-1];if(!s.collapsed||(u&&u.collapsed||r.push(o.renderCollapsedDivider()),!t)){r.push(o.renderComment(s));var m=e[l+1];a&&!i&&s.featured&&(!m||!m.featured)&&(i=!0,o.lastFeaturedIndex=l,r.push(c.a.createElement("div",{className:"CommentList-divider",key:"divider-featured"},c.a.createElement("div",{className:"CommentList-dividerLine"}),c.a.createElement("div",{className:"CommentList-dividerText"},"以上为精选评论",c.a.createElement(b.a,{className:"CommentList-questionMark","data-tooltip":"精选评论包含回答作者推荐的评论和部分高赞评论",center:!0,size:16})))))}}})}return r},o.renderCollapsedComments=function(){var e=[],t=o.props.collapsedComments;return o.state.collapsed||!t||t.length<=0?[]:(e.push(t.map(function(e){return o.renderComment(e)})),e)},o.renderComments=function(e){return e.map(o.renderComment)},o.renderBottomButton=function(){var e=o.props.params,t=e.id,n=e.answerId,r=Boolean(n);return c.a.createElement("div",{className:"Comments-footer CommentEditor--normal"},c.a.createElement(k.c,{className:"CommentEditor-startCommentButton",preset:"primary",color:"blue",onClick:function(){return Object(C.b)(Object(O.a)(r?{type:"answer",id:n}:{type:"question",id:t},{utm_content:"comment_area"}),{zaProps:{id:3906}})}},"打开 App 参与站内讨论"))},o.load=o.load.bind(o),o.loadByPagination=o.loadByPagination.bind(o),o.addComment=o.addComment.bind(o),o.featureItem=o.featureItem.bind(o),o.handleScroll=o.handleScroll.bind(o),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),L(t,[{key:"componentDidMount",value:function(){this.subscription=Object(h.subscribe)("scroll",this.handleScroll);var e=this.props,t=e.byComment,n=e.commentPattern,o=e.parent.adminClosedComment,r=this.state.current;t&&this.scrollToTarget(),"bottom"!==n||o||(this.loadByPagination(r),this.commentsWithPaginationEl&&this.setState({packupButtonLeft:this.commentsWithPaginationEl.getBoundingClientRect().right-16}))}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.order,o=t.status,r=t.targetComment,a=t.commentPattern;n===e.order&&o===e.status||("bottom"===a?(this.setState({current:1}),this.loadByPagination(1,e)):this.load(e),this.setState({collapsed:!0}));var i=e.targetComment;!r&&i&&this.setState({collapsed:!i.collapsed})}},{key:"componentDidUpdate",value:function(e){!e.comments.length&&this.props.comments.length&&this.props.byComment&&this.scrollToTarget()}},{key:"componentWillUnmount",value:function(){this.props.dispatch(Object(N.d)(N.b)),this.subscription&&this.subscription.unsubscribe()}},{key:"load",value:function(e,t,n){if(!this.props.isFetching&&!this.props.parent.adminClosedComment){var o=e||this.props,r=o.order,a=o.byComment,i=o.status,s=o.parent,c=s.id,l=s.type,u=o.dispatch,m=o.commentPattern;if(o.needLoadCommentPermission&&A(l,c)&&u(A(l,c)),n){u(Object(p.e)(l,c,{order:r,isPrevious:t,byComment:a,status:"collapsed",commentPattern:m},!0))}else u(Object(p.e)(l,c,{order:r,isPrevious:t,byComment:a,status:i,commentPattern:m}))}}},{key:"addComment",value:function(e,t){var n=this.props,o=n.parent,r=o.id,a=o.type,i=n.dispatch,s=[a,r,e];return t&&(s[3]=t.id),i(p.a.apply(void 0,s))}},{key:"featureItem",value:function(e){this.props.onItemFeature(e,this.lastFeaturedIndex)}},{key:"handleScroll",value:function(){if(this.commentsElement&&this.commentsWithPaginationEl){var e=window.innerHeight,t=this.state.packupButtonStatus,n=this.commentsWithPaginationEl.getBoundingClientRect(),o=n.top,r=n.bottom,a=n.height;!t&&a>500&&r>e&&o<0?this.setState({packupButtonStatus:!0}):t&&(a<=500||r<=e||o>=0)&&this.setState({packupButtonStatus:!1})}}},{key:"scrollToTarget",value:function(){var e=this.targetCommentEl,t=this.listEl;if(t&&e){var n=e.getBoundingClientRect(),o=n.top,r=n.height,a=t.getBoundingClientRect(),i=a.top,s=a.height;this.listEl.scrollTop+=o-i-(s-r)/2,e.classList.add("CommentItem--highlighted"),setTimeout(function(){return e.classList.remove("CommentItem--highlighted")},2e3),e.tabIndex=-1,e.focus()}}},{key:"loadByPagination",value:function(e,t){var n=t||this.props,o=n.order,r=n.byComment,a=n.status,i=n.parent,s=i.id,c=i.type,l=n.dispatch,u=n.commentPattern;n.needLoadCommentPermission&&A(c,s)&&l(A(c,s)),l(Object(p.e)(c,s,{order:o,isPrevious:!1,byComment:r,status:a,commentPattern:u,current:e}))}},{key:"renderCollapsedDivider",value:function(){var e=this.props,t=e.isDrained,n=e.parent.collapsedCounts;return!t||n<=0?[]:this.state.collapsed?c.a.createElement("div",{className:"CommentList-action",key:"collapsed"},c.a.createElement("div",{className:"CommentList-expendCollapseButton"},c.a.createElement("span",{onClick:this.handleOpenCollapsed},Object(P.formatNumber)(n)," 条评论被折叠"),"（",c.a.createElement("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）")):c.a.createElement("div",{className:"CommentList-divider",key:"divider-collapsed"},c.a.createElement("div",{className:"CommentList-dividerLine"}),c.a.createElement("div",{className:"CommentList-dividerText"},Object(P.formatNumber)(n)," 条评论被折叠（",c.a.createElement("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）"))}},{key:"renderCollapsedInfiLoader",value:function(){var e=this,t=this.state.collapsed;if(t)return[];var n=this.props.collapsedInfo,o=(n=void 0===n?{}:n).isFetching,r=n.isPrevDrained,a=n.isDrained;return c.a.createElement(E.b,{className:"CommentList",onRef:function(t){e.listEl=t},isLocal:!0,isLoading:o,isPrevDrained:r,isDrained:a,onLoad:function(n){return e.load(e.props,n,!t)},placeholder:c.a.createElement(E.a,{className:"CommentItem",small:!0})},this.renderCollapsedComments())}},{key:"renderPatternContent",value:function(e){var t=this,n=this.props,o=n.isFetching,r=n.parent.adminClosedComment,a=n.byComment,i=n.status,s=n.order,l=n.totals,u=n.showPackupButton,m=n.handlePackupButton,p=Math.ceil(l/20),f=this.state,h=f.current,v=f.packupButtonStatus,y=f.packupButtonLeft;return r?null:o?c.a.createElement(T.a,{onRef:function(e){t.commentsWithPaginationEl=e}}):c.a.createElement("div",{ref:function(e){t.commentsWithPaginationEl=e}},c.a.createElement("div",{className:"CommentList"},"normal"===s&&"open"===i?this.renderNormalComments(e):this.renderComments(e)),p>1&&c.a.createElement(w.a,{className:"comments-pagination",current:h,total:p,onSelect:this.handlePageSelect}),!a&&this.renderCollapsedDivider(),!a&&this.renderCollapsedInfiLoader(),c.a.createElement(d.CSSTransitionGroup,{transitionName:"Comments-Packup-Button",transitionEnterTimeout:300,transitionLeaveTimeout:300},u&&v&&c.a.createElement("button",{onClick:m,className:"Comments-Packup-Button",style:{left:y}},"收起评论",c.a.createElement(g.a,{center:!0}))))}},{key:"renderModalContent",value:function(e){var t=this,n=this.props,o=n.collapsedInfo,r=n.parent.adminClosedComment,a=n.status,i=n.order,s=n.byComment,l=this.state.collapsed,u=l?this.props:o,m=u.isFetching,p=u.isDrained,d=u.isPrevDrained;if(p&&e.length<=0||r)return c.a.createElement("div",{className:"Comments-empty"},c.a.createElement(R.a,{entityType:"comments"}));var f={getContainer:function(e){return e}};return c.a.createElement(E.b,D({className:"CommentList",onRef:function(e){t.listEl=e},isLocal:!0,isLoading:m,isPrevDrained:d,isDrained:p,onLoad:function(e){return t.load(t.props,e,!l)},placeholder:c.a.createElement(E.a,{className:"CommentItem",small:!0})},f),"normal"===i&&"open"===a?this.renderNormalComments(e):this.renderComments(e),!s&&this.renderCollapsedDivider(),!s&&this.renderCollapsedComments())}},{key:"renderCommentEdit",value:function(e){var t=this.props,n=t.parent,o=n.canComment,r=(o=void 0===o?{status:!0}:o).status,a=o.reason,i=n.author,s=(i=void 0===i?{isOrg:!1}:i).isOrg,l=n.type,u=n.id,p=n.adminClosedComment,d=n.questionType,h=t.byComment,v=t.autoFocus,y=t.commentNeedsReview,b=p?"当前内容暂时无法评论":a,g=v&&!h;return r&&!p?c.a.createElement(_.a,D({className:"Comments-"+("top"===e?"top":"footer"),type:l,id:u,commentNeedsReview:y,onSubmit:this.addComment,autoFocus:g,ownerAuthorIsOrg:s,ownerAuthorIsBrand:"commercial"===d},"top"===e&&{preset:"default",onClick:function(e){f.default.trackEvent(e.target,{id:3905})}})):"top"!==e&&c.a.createElement("div",{className:m()("Comments-disabledText",{"Comments-disabledText--fixed":void 0})},c.a.createElement("div",{className:"Comments-disabledReason"},b))}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,o=t.isAuthor,r=t.comments,a=t.commentPattern,i=t.commentInputPosition,s=t.parent,l=s.canComment,u=(l=void 0===l?{status:!0}:l).status,p=s.author,d=(p=void 0===p?{isOrg:!1}:p).isOrg,f=s.commentPermission,h=s.reviewingCounts,v=s.commentCount,y=s.adminClosedComment,b=t.totals,g=t.status,C=t.order,E=t.onStatusChange,w=t.onOrderChange,k=t.targetLink,P=r.filter(function(e){return!e.isDelete}),O="censor"===f&&o,N=O?{isCommentReviewer:O,onStatusChange:E,status:g,reviewingCounts:h}:{status:g},S=m()({Comments:!0,"Comments--withEditor":!0,"Comments-withPagination":"bottom"===a},n);return c.a.createElement("div",{className:S,ref:function(t){e.commentsElement=t}},c.a.createElement(x.a,D({commentCount:void 0!==v?v:b,commentClosed:y,targetLink:k,order:C,onOrderChange:w,commentPattern:a,isOrg:d,options:this.renderCommentEdit("top")},N)),"top"===i&&this.renderCommentEdit(),"bottom"===a?this.renderPatternContent(P):this.renderModalContent(P),"bottom"===i&&!u&&this.renderCommentEdit(),"bottom"===i&&u&&this.renderBottomButton())}}]),t}(),o.propTypes={type:i.a.string,parent:i.a.object.isRequired,targetLink:i.a.node,commentNeedsReview:i.a.bool,byComment:i.a.oneOfType([i.a.number,i.a.string]),commentPattern:i.a.string,commentInputPosition:i.a.oneOf(["top","bottom"]),showPackupButton:i.a.bool,handlePackupButton:i.a.func,onPaginationClick:i.a.func,autoFocus:i.a.bool},o.contextTypes={authRequired:i.a.func.isRequired},o.defaultProps={commentInputPosition:"bottom",showPackupButton:!0,autoFocus:!0},r),q=Object(l.connect)(function(e,t){var n=t.parent,o=t.parent,r=o.type,a=o.id,i=t.status,s=t.order,c=t.byComment,l=t.commentPattern,u=e.entities,m=e.comments,p=r+"_"+a,d=m.parent,f=m.pagination;"reviewing"===i&&(f=m.reviewing),"reverse"===s&&"open"===i&&(f=m.reverse);var h=[],v=m.collapsed[p]||{};v.ids&&v.ids.length>0&&(h=v.ids.map(function(e){return u.comments[e]}));var y=f[p]||{isPrevDrained:!1,isFetching:!1,isDrained:!1,ids:[]},b=y.isFetching,g=y.isPrevDrained,C=y.isDrained,E=y.ids,w=y.newIds,k=void 0===w?[]:w;return{isFetching:b,isPrevDrained:g,isDrained:C,totals:y.totals,comments:("bottom"!==l?E:k).map(function(e){return u.comments[e]}),collapsedInfo:v,collapsedComments:h,targetComment:u.comments[c],parent:D({},n,d[p])}})(F),z=n(23),V=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var U,W,H,K,G=(B=M=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.load=o.load.bind(o),o.addComment=n.authRequired(o.addComment.bind(o),void 0,N.b),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),V(t,[{key:"componentDidMount",value:function(){this.load()}},{key:"load",value:function(){this.props.dispatch(Object(p.f)(this.props.commentId))}},{key:"addComment",value:function(e,t){var n=this.props,o=n.parent,r=o.type,a=o.id,i=n.commentId,s=n.dispatch,c=[r,a,e,t.id,i];return s(p.a.apply(void 0,c))}},{key:"render",value:function(){var e=this.props,t=e.onItemLike,n=e.onItemDelete,o=e.onItemFeature,r=e.onItemApprove,a=e.onItemCollapse,i=e.onItemDislike,s=e.onNavBack,l=e.canOperateItem,u=e.isFetching,m=e.comments,p=e.commentNeedsReview,d=e.openComment.collapsed,f=e.parent,h=e.parent.canComment,v=(h=void 0===h?{status:!0}:h).status,y=h.reason,b=e.commentPattern,g=e.commentId,C=this.context.currentUser,w=void 0,k=void 0;Boolean(C&&m.find(function(e){return e.author&&e.author.member.urlToken===C.urlToken}))&&(k=(w=m.filter(function(e){return e.author&&e.author.member.urlToken!==C.urlToken}))[w.length-1]);var P=void 0;return u&&!m.length?P=c.a.createElement(E.a,{className:"CommentItem",small:!0}):m.length&&(P=m.map(function(e,s){return c.a.createElement(j.a,{key:s,isConversation:!0,commentNeedsReview:p,canOperate:l,parent:f,comment:e,onLike:t,onDelete:n,onFeature:o,onApprove:r,onCollapse:a,onDislike:i,collapsedShown:d})})),"bottom"===b?c.a.createElement(z.b,{size:"fullPage",onClose:s},c.a.createElement("div",{className:"Comments"},c.a.createElement(x.a,{isConversation:!0,commentPattern:b}),c.a.createElement("div",{className:"CommentList"},P))):c.a.createElement("div",{className:"Comments"},c.a.createElement(x.a,{isConversation:!0,onNavBack:s}),c.a.createElement("div",{className:"CommentList"},P),k&&(v?c.a.createElement(_.a,{id:g,type:"conversation",className:"Comments-footer",replyTo:k,commentNeedsReview:p,onSubmit:this.addComment}):c.a.createElement("div",{className:"Comments-disabledText"},y)))}}]),t}(),M.propTypes={commentId:i.a.number.isRequired,type:i.a.string,parent:i.a.object.isRequired,commentNeedsReview:i.a.bool},M.contextTypes={currentUser:i.a.object,authRequired:i.a.func.isRequired},B),Q=Object(l.connect)(function(e,t){var n=t.commentId,o=e.entities.comments,r=e.comments.conversation[n]||{isFetching:!1,isDrained:!1,ids:[]};return{isFetching:r.isFetching,isDrained:r.isDrained,comments:r.ids.map(function(e){return o[e]}),openComment:o[n]}})(G),$=n(48),Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},J=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Y=Object($.a)(null)((H=W=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));K.call(n);var o=e.parent,r=e.dispatch;return n.feature=function(e,t){return r(Object(p.i)(e,o.id,o.type,t))},n.delete=function(e){return r(Object(p.d)(e,o.type,o.id))},n.showConversation=function(e){return n.setState({openedCommentId:e})},n.showComments=function(){return n.setState({openedCommentId:null})},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["Component"]),J(t,[{key:"componentDidMount",value:function(){var e=this.props.onMount;e&&e(this.domNode)}},{key:"render",value:function(){var e=this,t=this.props,n=t.parent,o=t.commentPattern,r=t.type,a=t.parent,i=(a=void 0===a?{}:a).commentPermission,s=a.relationship,l=void 0===s?{}:s,u=a.author,p=void 0===u?{}:u,d=t.needLoadCommentPermission,f=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(t,["parent","commentPattern","type","parent","needLoadCommentPermission"]),h=this.context.currentUser,v=void 0===l.isAuthor?h&&p.urlToken&&h.urlToken===p.urlToken:l.isAuthor,y="censor"===i&&!v,b="answer"===r||"article"===r,g=this.state,C=g.openedCommentId,E=g.status,w=g.order,k={commentNeedsReview:y,parent:n,type:r,canOperateItem:b,onShowConversation:this.showConversation,onItemLike:this.like,onItemFeature:this.feature,onItemDelete:this.delete,onItemCollapse:this.collapse,onItemDislike:this.dislike,onItemApprove:this.approve};return c.a.createElement("div",{className:"Comments-container",ref:function(t){return e.domNode=t}},c.a.createElement(q,Z({},f,k,{commentPattern:o,className:m()({"Comments--hidden":C&&"bottom"!==o}),order:w,status:E,onStatusChange:this.handleStatusChange,onOrderChange:this.handleOrderChange,needLoadCommentPermission:d,isAuthor:v})),C&&c.a.createElement(Q,Z({},f,k,{commentPattern:o,commentId:C,onNavBack:this.showComments})))}}]),t}(),W.propTypes={type:i.a.string.isRequired,parent:i.a.object.isRequired,onOrderChange:i.a.func,onItemLike:i.a.func,isAuthor:i.a.bool,onMount:i.a.func},W.defaultProps={type:"answer"},W.contextTypes={currentUser:i.a.object,authRequired:i.a.func.isRequired},K=function(){var e=this;this.state={openedCommentId:null,status:"open",order:"normal"},this.like=function(t,n){var o=e.props,r=o.onItemLike,a=o.dispatch;r&&r(t,n),a(Object(p.j)(t))},this.collapse=function(t){var n=e.props,o=n.dispatch,r=n.parent;o(Object(p.g)(t,r.type,r.id))},this.dislike=function(t){return e.props.dispatch(Object(p.h)(t))},this.approve=function(t){var n=e.props,o=n.dispatch,r=n.parent,a=n.type;o(Object(p.b)(t,r.type||a,r.id))},this.handleStatusChange=function(t){e.setState({status:t})},this.handleOrderChange=function(t,n){e.props.onOrderChange&&e.props.onOrderChange(t,n),e.setState({order:t})}},U=H))||U;t.default=Object(l.connect)()(Y)}}]);
//# sourceMappingURL=column.modals.d7a2d142ec4506ae7fec.js.map