
#define AAD qx.push(i),qy.push(j-1),a[i][j-1]=t,p=max(t,p),t=0;
#define AAC if(a[i][j]==-2&&(a[i][j-1]>0||a[i][j+1]>0))
#define AAB if(c=='+'||c=='-'||c=='|') a[i][j]=-2;
#define AAA freopen("clickbait.out","w",stdout);
#define AA9 freopen("clickbait.in","r",stdin);
#define AA8 sort(f[i]+1,f[i]+f[i][0].x+1,cmp);
#define AA7 if(a[x+i][y+j]>0&&a[x+i][y+j]!=u)
#define AA6 pp=max(a[i][j-1],a[i][j+1]);
#define AA5 x=qx.front(),y=qy.front();
#define AA4 qx.push(x+i),qy.push(y+j);
#define AA3 f[pp][++f[pp][0].y].y=j;
#define AA2 f[pp][++f[pp][0].x].x=i;
#define AA1 x=f[u][i].x,y=f[u][i].y;
#define AA0 scanf("%d %d\n",&n,&m);
#define A9F n,m,a[maxn][maxn],p;
#define A9E a[x+i][y+j]=a[x][y];
#define A9D if(a[x+i][y+j]==-2)
#define A9C if(a[x+i][y+j]==0)
#define A9B while(!qx.empty())
#define A9A printf("%d\n",u);
#define A99 dfs(a[x+i][y+j]);
#define A98 if(f[u][0].x==0)
#define A97 if(48<=c&&c<=57)
#define A96 t=t*10+c-48;else
#define A95 }f[maxn][maxn];
#define A94 i<=f[u][0].x;
#define A93 ___0xffff___
#define A92 c=getchar();
#define A91 a[x][y]=-1;
#define A90 maxn=3077;
#define A8F 0x6348cf46
#define A8E getchar();
#define A8D queue<int>
#define A8C 0x63477d8a
#define A8B b=0,b1=0;
#define A8A namespace
#define A89 qy.pop();
#define A88 qx.pop();
#define A87 while(1)
#define A86 if(i||j)
#define A85 x.x>y.x;
#define A84 dfs(1);
#define A83 dfs(int
#define A82 return;
#define A81 doit();
#define A80 for(int
#define A7F break;
#define A7E struct
#define A7D return
#define A7C doit()
#define A7B bfs();
#define A7A qx,qy;
#define A79 if(b1)
#define A78 printf
#define A77 i<=1;
#define A76 i<=n;
#define A75 i<=p;
#define A74 i=-1;
#define A73 if(b)
#define A72 if(t)
#define A71 j<=m;
#define A70 j=-1;
#define A6F using
#define A6E x+=i;
#define A6D y+=j;
#define A6C }else
#define A6B b1=0;
#define A6A b1=1;
#define A69 bfs()
#define A68 j<=1;
#define A67 cmp(F
#define A66 const
#define A65 "%s"
#define A64 "\n"
#define A63 0xc1
#define A62 0xbc
#define A61 0x64
#define A60 0xb9
#define A5F t=0;
#define A5E 0xb7
#define A5D time
#define A5C void
#define A5B 0x20
#define A5A 0x23
#define A59 0x2d
#define A58 0x2e
#define A57 0x2f
#define A56 0x3a
#define A55 0x61
#define A54 0x62
#define A53 0x63
#define A52 0x65
#define A51 0x66
#define A50 0x68
#define A4F 0x6d
#define A4E 0x6f
#define A4D 0x70
#define A4C 0x73
#define A4B 0x74
#define A4A 0x78
#define A49 0xb5
#define A48 0xa7
#define A47 0xb4
#define A46 else
#define A45 x,y;
#define A44 0xb1
#define A43 0xaa
#define A42 0xa8
#define A41 0xf8
#define A40 0xfd
#define A3F i++)
#define A3E b=1;
#define A3D 0xfa
#define A3C b=0;
#define A3B char
#define A3A bool
#define A39 i=1;
#define A38 std;
#define A37 0xf7
#define A36 0xeb
#define A35 0xe8
#define A34 0xe7
#define A33 0xdf
#define A32 main
#define A31 0xde
#define A30 0xda
#define A2F 0xd7
#define A2E 0xd5
#define A2D j++)
#define A2C 0xd4
#define A2B j=1;
#define A2A 0xd3
#define A29 0xd2
#define A28 0xd1
#define A27 0xd0
#define A26 0xcf
#define A25 0xce
#define A24 0xcc
#define A23 0xcb
#define A22 0xca
#define A21 0xc8
#define A20 0xc7
#define A1F 0xc6
#define A1E 0xc3
#define A1D 0xc2
#define A1C 0x0
#define A1B 0xa
#define A1A x,F
#define A19 int
#define A18 &&
#define A17 ()
#define A16 0;
#define A15 if
#define A14 u)
#define A13 y)
#define A12 d,
#define A11 (
#define A10 )
#define AF ,
#define AE 0
#define AD e
#define AC >
#define AB =
#define AA <
#define A9 ;
#define A8 b
#define A7 d
#define A6 ]
#define A5 c
#define A4 a
#define A3 [
#define A2 {
#define A1 }
#define A0 F
#include <time.h>
#include<bits/stdc++.h>
#define AAE A6F A8A A38 A66 A19 A90 A8D A7A A7E A0
#define AAF A2 A19 A45 A95 A19 A9F A19 A67 A1A A13
#define AB0 A2 A7D A85 A1 A5C A69 A2 A9B A2 A19
#define AB1 AA5 A88 A89 A80 A74 A77 A3F A2 A80 A70
#define AB2 A68 A2D A86 A2 A9C AA4 A9E A1 A1 A1
#define AB3 A1 A5C A7C A2 A80 A39 A76 A3F A2 A80
#define AB4 A2B A71 A2D A2 AAC A2 A19 AA6 AA2 AA3
#define AB5 A1 A1 A1 A1 A5C A83 A14 A2 A98 A2
#define AB6 A9A A82 A1 A80 A39 A94 A3F A2 A19 AA1
#define AB7 A91 A3A A8B A87 A2 A3C A6B A80 A74 A77
#define AB8 A3F A2 A80 A70 A68 A2D A86 A2 A9D A2
#define AB9 A6E A6D A91 A6A A7F A6C AA7 A2 A99 A3E
#define ABA A6A A7F A1 A1 A79 A7F A1 A73 A7F A1
#define ABB A1 A9A A1 A19 A93 A17 A2 AA9 AAA AA0
#define ABC A80 A39 A76 A3F A2 A19 A5F A80 A2B A71
#define ABD A2D A2 A3B A92 A97 A96 A2 A72 AAD A1
#define ABE AAB A1 A8E A1 A7B A81 A80 A39 A75 A3F
#define ABF AA8 A84 A7D A16 A1 A19 A32 A11 A10 A2
#define AC0 A15 A11 A5D A11 AE A10 AC A8C A18 A5D
#define AC1 A11 AE A10 AA A8F A10 A2 A93 A11 A10
#define AC2 A9 A1 A46 A2 A3B A4 A3 A6 AB A2
#define AC3 A11 A3B A10 A5A AF A11 A3B A10 A5B AF
#define AC4 A11 A3B A10 A47 AF A11 A3B A10 A3D AF
#define AC5 A11 A3B A10 A1D AF A11 A3B A10 A36 AF
#define AC6 A11 A3B A10 A22 AF A11 A3B A10 A44 AF
#define AC7 A11 A3B A10 A27 AF A11 A3B A10 A48 AF
#define AC8 A11 A3B A10 A60 AF A11 A3B A10 A40 AF
#define AC9 A11 A3B A10 A1F AF A11 A3B A10 A30 AF
#define ACA A11 A3B A10 A29 AF A11 A3B A10 A28 AF
#define ACB A11 A3B A10 A25 AF A11 A3B A10 A31 AF
#define ACC A11 A3B A10 A5E AF A11 A3B A10 A42 AF
#define ACD A11 A3B A10 A2C AF A11 A3B A10 A23 AF
#define ACE A11 A3B A10 A27 AF A11 A3B A10 A27 AF
#define ACF A11 A3B A10 A5B AF A11 A3B A10 A5A AF
#define AD0 A11 A3B A10 A1C A1 A9 A3B A8 A3 A6
#define AD1 AB A2 A11 A3B A10 A5A AF A11 A3B A10
#define AD2 A5B AF A11 A3B A10 A21 AF A11 A3B A10
#define AD3 A34 AF A11 A3B A10 A27 AF A11 A3B A10
#define AD4 A35 AF A11 A3B A10 A62 AF A11 A3B A10
#define AD5 A24 AF A11 A3B A10 A27 AF A11 A3B A10
#define AD6 A41 AF A11 A3B A10 A22 AF A11 A3B A10
#define AD7 A60 AF A11 A3B A10 A2A AF A11 A3B A10
#define AD8 A1E AF A11 A3B A10 A20 AF A11 A3B A10
#define AD9 A36 AF A11 A3B A10 A63 AF A11 A3B A10
#define ADA A43 AF A11 A3B A10 A26 AF A11 A3B A10
#define ADB A49 AF A11 A3B A10 A2F AF A11 A3B A10
#define ADC A37 AF A11 A3B A10 A2E AF A11 A3B A10
#define ADD A33 AF A11 A3B A10 A5B AF A11 A3B A10
#define ADE A5A AF A11 A3B A10 A1C A1 A9 A3B A5
#define ADF A3 A6 AB A2 A11 A3B A10 A59 AF A11
#define AE0 A3B A10 A59 AF A11 A3B A10 A5B AF A11
#define AE1 A3B A10 A50 AF A11 A3B A10 A4B AF A11
#define AE2 A3B A10 A4B AF A11 A3B A10 A4D AF A11
#define AE3 A3B A10 A4C AF A11 A3B A10 A56 AF A11
#define AE4 A3B A10 A57 AF A11 A3B A10 A57 AF A11
#define AE5 A3B A10 A53 AF A11 A3B A10 A4E AF A11
#define AE6 A3B A10 A61 AF A11 A3B A10 A52 AF A11
#define AE7 A3B A10 A51 AF A11 A3B A10 A4E AF A11
#define AE8 A3B A10 A4A AF A11 A3B A10 A58 AF A11
#define AE9 A3B A10 A4B AF A11 A3B A10 A55 AF A11
#define AEA A3B A10 A4E AF A11 A3B A10 A54 AF A11
#define AEB A3B A10 A55 AF A11 A3B A10 A4E AF A11
#define AEC A3B A10 A58 AF A11 A3B A10 A53 AF A11
#define AED A3B A10 A4E AF A11 A3B A10 A4F AF A11
#define AEE A3B A10 A5B AF A11 A3B A10 A59 AF A11
#define AEF A3B A10 A59 AF A11 A3B A10 A1B AF A11
#define AF0 A3B A10 A1C A1 A9 A3B A7 A3 A6 AB
#define AF1 A65 A9 A3B AD A3 A6 AB A64 A9 A78
#define AF2 A11 A12 A4 A10 A9 A78 A11 AD A10 A9
#define AF3 A78 A11 A12 A8 A10 A9 A78 A11 AD A10
#define AF4 A9 A78 A11 A12 A5 A10 A9 A1 A7D A16
#define AF5 A1 
#define AF6 AAE AAF AB0 AB1 AB2 AB3 AB4 AB5 AB6 AB7
#define AF7 AB8 AB9 ABA ABB ABC ABD ABE ABF AC0 AC1
#define AF8 AC2 AC3 AC4 AC5 AC6 AC7 AC8 AC9 ACA ACB
#define AF9 ACC ACD ACE ACF AD0 AD1 AD2 AD3 AD4 AD5
#define AFA AD6 AD7 AD8 AD9 ADA ADB ADC ADD ADE ADF
#define AFB AE0 AE1 AE2 AE3 AE4 AE5 AE6 AE7 AE8 AE9
#define AFC AEA AEB AEC AED AEE AEF AF0 AF1 AF2 AF3
#define AFD AF4 AF5 
#define AFE AF6 AF7 AF8 AF9 AFA AFB AFC AFD 
#define AFF(__FOX__) __FOX__
AFF(AFE)
