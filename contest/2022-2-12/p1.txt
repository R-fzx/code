筹备计划（position/2s/256m/传统）

【问题描述】
同学们在操场上排成一个队形，我们将他们的位置描述为数轴上1到n的整点。一个位置可以有很多个人，也可以一个人也没有。
教官有一种特殊能力：花费0时间传送到1到n的任一整点。这个特殊能力每天只能使用一次。教官传送后，数轴上的所有同学就会聚集到教官的位置。
现在，你需要找到数轴上的一个整点，使得教官传送到这个位置后，最小化所有同学到该点走的距离总和。
接下来的q天，上述状况每天会发生一次。
每天，同学们的队形状态会发生一次变化，我们将它称作一次事件。一次事件可以为：在某个位置的同学增加k个或减少k个。一次事件也可以为：令某个区间内的整点不能成为传送到的点，或者某个区间内的整点重新成为可以传送到的点（不保证该区间的整点在变化前不是能传送到的点）。这些变化都是会保留的。
请问每次变化后，将教官传送到哪个位置是最优的，若有多个位置同时满足是最优的答案，那么同学们会选择最靠左的那个。
刚开始，所有整点都可以传送到。

【输入格式】
第一行包含两个整数n，q，表示整点的范围和发生的天数。
第二行包含n个整数，第i个整数ai表示在初始时刻每个位置上的学生数量。
接下来q行每行先有一个整数type。
若type=1，接下来有两个整数x,k，表示在x位置增加k名学生。
若type=2，接下来有两个整数x,k，表示在x位置减少k名学生，保证x位置一定存在至少k名学生。
若type=3，接下来有两个整数l,r，表示在[l,r]这段区间的点可以重新传送到。
若type=4，接下来有两个整数l,r，表示在[l,r]这段区间的点不能传送到。

【输出格式】
输出总共q行，第i行的数为第i个事件发生后的答案。
无解输出-1。

【样例输入】
5 4
1 0 1 0 0
1 4 1
2 3 1
4 1 3
3 2 3

【样例输出】
3
1
4
2

【样例解释】
总共5个位置可以选择。
第1个事件发生，新增加一名学生在4号位置。
第2个事件发生以前，学生分别在1,3,4位置，可以证明，在3的位置距离和最小且它是最靠左的那一个。
第2个事件发生，减少一名在3位置的学生。
第3个事件发生以前，学生分别在1,4位置，可以证明，在1的位置距离和最小且它是最靠左的那一个。
第3个事件发生，1到3号位置不能传送到。
第4个事件发生以前，学生分别在1,4位置，且1到3号位置不能传送到，可以证明，在4的位置距离和最小且它是最靠左的那一个。
第4个事件发生，2到3号位置能重新传送到。
最后，学生分别在1,4位置，且1号位置不能传送到，可以证明，在2的位置距离和最小且它是最靠左的那一个。

【数据规模及约定】
对于20%的数据，n≤200，q≤200；
对于50%的数据，n≤2000，q≤2000；
对于另30%的数据，不存在type=3和type=4的操作；
对于100%的数据，1≤n≤2*10^5, 1≤q≤2*10^5, 1≤k≤2*10^5, 0≤ai≤2*10^5。
本题输入输出规模较大，请使用较为快速的输入输出方式。


