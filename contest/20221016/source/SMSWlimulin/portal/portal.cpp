/*
*********************************
*       øÒ¿«µÁæ∫æ„¿÷≤ø 
*
*           TheBian
*  
*********************************
*/
#define BFF if(tx < 1 || tx > n || ty < 1 || ty > m || Map[tx][ty] == '#') continue;
#define BFE freopen("portal.out","w",stdout);
#define BFD while(Map[tx][ty] != '#') ty ++;
#define BFC while(Map[tx][ty] != '#') tx ++;
#define BFB while(Map[tx][ty] != '#') tx --;
#define BFA while(Map[tx][ty] != '#') ty --;
#define BF9 freopen("portal.in","r",stdin);
#define BF8 memset(Dis,0x3f,sizeof(Dis));
#define BF7 {{1,0},{-1,0},{0,1},{0,-1}};
#define BF6 else cout << "nemoguce";
#define BF5 scanf("%s",Map[i] + 1);
#define BF4 if(Map[i][j] == 'F') {
#define BF3 if(Map[i][j] == 'C') {
#define BF2 if(Map[i][j] != '#') {
#define BF1 scanf("%d%d",&n,&m);
#define BF0 priority_queue<Unit>
#define BEF while(!que.empty())
#define BEE Map[MAXN][MAXN];
#define BED Stx,Sty,Edx,Edy;
#define BEC Add(From,To,d);
#define BEB Add(From,To,1);
#define BEA que.push((Unit)
#define BE9 Edge[Cnt].Next
#define BE8 Edge[Cnt].Wei
#define BE7 Loss[k][0],ty
#define BE6 Edge[i].Next)
#define BE5 ___0xffff___
#define BE4 Edge[Cnt].To
#define BE3 Edge[i].Wei;
#define BE2 que.top().x;
#define BE1 if(!Vis[y])
#define BE0 Dijkstra();
#define BDF if(Dis[(Edx
#define BDE Edge[i].To;
#define BDD Edge[i].Wei
#define BDC 0x3f3f3f3f)
#define BDB Loss[k][1];
#define BDA que.pop();
#define BD9 MAXN],Cnt;
#define BD8 0x634b793e
#define BD7 (Wall[k].x
#define BD6 Loss[7][7]
#define BD5 0x634ccafa
#define BD4 Dijkstra()
#define BD3 if(Vis[x])
#define BD2 Wall[1].y
#define BD1 Wall[3].x
#define BD0 Wall[1].x
#define BCF Edge[MAXN
#define BCE continue;
#define BCD Wall[2].x
#define BCC namespace
#define BCB Wall[k].y
#define BCA Wall[2].y
#define BC9 if(Dis[x]
#define BC8 Head[MAXN
#define BC7 Wall[10];
#define BC6 Wall[4].y
#define BC5 Wall[4].x
#define BC4 Wall[3].y
#define BC3 Head[x];
#define BC2 Dis[MAXN
#define BC1 Dis[(Stx
#define BC0 min(d,ty
#define BBF operator
#define BBE Head[u];
#define BBD Vis[MAXN
#define BBC y,Dis[y]
#define BBB min(d,tx
#define BBA Dis[(Edx
#define BB9 Dis[y])
#define BB8 for(int
#define BB7 Add(int
#define BB6 Head[u]
#define BB5 min(d,x
#define BB4 min(d,y
#define BB3 (const
#define BB2 _Wall{
#define BB1 Vis[x]
#define BB0 MAXN];
#define BAF 10000;
#define BAE printf
#define BAD 1][0])
#define BAC Loss[k
#define BAB return
#define BAA Dis[x]
#define BA9 struct
#define BA8 Dis[y]
#define BA7 1][1];
#define BA6 _Edge{
#define BA5 Next;
#define BA4 Edy];
#define BA3 const
#define BA2 u,int
#define BA1 using
#define BA0 v,int
#define B9F Sty,0
#define B9E Unit{
#define B9D 0xc3
#define B9C 0xc6
#define B9B 0xc7
#define B9A 0xc8
#define B99 0xca
#define B98 0xcb
#define B97 0xcc
#define B96 0xce
#define B95 0xcf
#define B94 0xd1
#define B93 0xd2
#define B92 0xd3
#define B91 0xd4
#define B90 0xd5
#define B8F 0xd7
#define B8E 0xda
#define B8D 0xde
#define B8C 0xdf
#define B8B 0xe7
#define B8A 0xe8
#define B89 0xeb
#define B88 0xf7
#define B87 0xf8
#define B86 0xfa
#define B85 0xfd
#define B84 10];
#define B83 505;
#define B82 Cnt;
#define B81 Edy]
#define B80 From
#define B7F 0xd0
#define B7E MAXN
#define B7D Sty]
#define B7C Unit
#define B7B Wei;
#define B7A a.w;
#define B79 bool
#define B78 char
#define B77 cout
#define B76 else
#define B75 i++)
#define B74 "%s"
#define B73 "\n"
#define B72 (Stx
#define B71 0x20
#define B70 0x23
#define B6F 0x2d
#define B6E 0x2e
#define B6D j++)
#define B6C k++)
#define B6B main
#define B6A 0x2f
#define B69 0x3a
#define B68 0x61
#define B67 0x62
#define B66 0x63
#define B65 n,m;
#define B64 0x64
#define B63 0x65
#define B62 0x66
#define B61 0x68
#define B60 0x6d
#define B5F 0x6f
#define B5E 0x70
#define B5D que;
#define B5C 0x73
#define B5B 0x74
#define B5A 0x78
#define B59 std;
#define B58 0xa7
#define B57 time
#define B56 tx);
#define B55 ty);
#define B54 0xa8
#define B53 0xaa
#define B52 0xb1
#define B51 void
#define B50 0xb4
#define B4F 0xb5
#define B4E 0xb7
#define B4D 0xb9
#define B4C 0xbc
#define B4B x,ty
#define B4A x,y;
#define B49 0xc1
#define B48 0xc2
#define B47 int
#define B46 ty;
#define B45 Edy
#define B44 0x0
#define B43 To;
#define B42 Edx
#define B41 (tx
#define B40 Stx
#define B3F });
#define B3E 0xa
#define B3D y,d
#define B3C tx;
#define B3B i,y
#define B3A Cnt
#define B39 y);
#define B38 x);
#define B37 ++;
#define B36 Sty
#define B35 (i
#define B34 To
#define B33 ()
#define B32 &&
#define B31 4;
#define B30 <<
#define B2F 1;
#define B2E j;
#define B2D x;
#define B2C 1)
#define B2B m;
#define B2A y;
#define B29 !=
#define B28 if
#define B27 0;
#define B26 i;
#define B25 n;
#define B24 a)
#define B23 };
#define B22 tx
#define B21 <=
#define B20 d,
#define B1F v;
#define B1E w)
#define B1D w;
#define B1C &
#define B1B <
#define B1A ;
#define B19 j
#define B18 k
#define B17 1
#define B16 0
#define B15 >
#define B14 a
#define B13 +
#define B12 *
#define B11 b
#define B10 (
#define BF d
#define BE x
#define BD ]
#define BC i
#define BB c
#define BA )
#define B9 =
#define B8 [
#define B7 ,
#define B6 -
#define B5 e
#define B4 {
#define B3 w
#define B2 }
#define B1 n
#define B0 y
#include <time.h>
#include <iostream>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#include <cmath>
#include <algorithm>
#include <queue>
#define B100 BA1 BCC B59 BA3 B47 B7E B9 B83 B78 BEE
#define B101 B47 BED B47 BC2 B12 BB0 B47 B65 BA9 BA6
#define B102 B47 BA5 B47 B43 B47 B7B B2 BCF B12 B7E
#define B103 B12 B84 B47 BC8 B12 BD9 B51 BB7 BA2 BA0
#define B104 B1E B4 B3A B37 BE9 B9 BBE BE4 B9 B1F
#define B105 BE8 B9 B1D BB6 B9 B82 B2 BA9 BB2 B47
#define B106 B4A B2 BC7 BA9 B9E B47 B2D B47 B1D B79
#define B107 BBF B1B BB3 B7C B1C B24 BA3 B4 BAB B3
#define B108 B15 B7A B2 B23 B47 BD6 B9 BF7 B47 BBD
#define B109 B12 BB0 B51 BD4 B4 BF0 B5D BF8 BC1 B6
#define B10A B2C B12 B1 B13 B7D B9 B27 BEA B4 B72
#define B10B B6 B2C B12 B1 B13 B9F B3F BEF B4 B47
#define B10C BE B9 BE2 BDA BD3 BCE BB1 B9 B2F BB8
#define B10D BC B9 BC3 B26 BC B9 BE6 B4 B47 B0
#define B10E B9 BDE BC9 B13 BDD B1B BB9 B4 BA8 B9
#define B10F BAA B13 BE3 BE1 BEA B4 BBC B3F B2 B2
#define B110 B2 B2 B47 BE5 B33 B4 BF9 BFE BF1 BB8
#define B111 BC B9 B2F BC B21 B25 B75 B4 BF5 BB8
#define B112 B19 B9 B2F B19 B21 B2B B6D B4 BF3 B40
#define B113 B9 B26 B36 B9 B2E B2 BF4 B42 B9 B26
#define B114 B45 B9 B2E B2 B2 B2 BB8 BC B9 B2F
#define B115 BC B21 B25 B75 B4 BB8 B19 B9 B2F B19
#define B116 B21 B2B B6D B4 B47 B80 B9 B35 B6 B2C
#define B117 B12 B1 B13 B2E BF2 B47 BE B9 B3B B9
#define B118 B2E B47 B22 B9 B4B B9 B3D B9 BAF BFB
#define B119 BD0 B9 B3C BD2 B9 B46 BF B9 BB5 B6
#define B11A B56 B22 B9 B4B B9 B2A BFC BCD B9 B3C
#define B11B BCA B9 B46 BF B9 BBB B6 B38 B22 B9
#define B11C B4B B9 B2A BFA BD1 B9 B3C BC4 B9 B46
#define B11D BF B9 BB4 B6 B55 B22 B9 B4B B9 B2A
#define B11E BFD BC5 B9 B3C BC6 B9 B46 BF B9 BC0
#define B11F B6 B39 BB8 B18 B9 B2F B18 B21 B31 B6C
#define B120 B4 B47 B34 B9 BD7 B6 B17 B13 BAC B6
#define B121 BAD B12 B1 B13 BCB B13 BAC B6 BA7 BEC
#define B122 B2 BB8 B18 B9 B27 B18 B1B B31 B6C B4
#define B123 B47 B22 B9 BC B13 BE7 B9 B19 B13 BDB
#define B124 BFF B47 B34 B9 B41 B6 B2C B12 B1 B13
#define B125 B46 BEB B2 B2 B2 B2 BE0 BDF B6 B2C
#define B126 B12 B1 B13 B81 B29 BDC B77 B30 BBA B6
#define B127 B2C B12 B1 B13 BA4 BF6 BAB B27 B2 B47
#define B128 B6B B10 BA B4 B28 B10 B57 B10 B16 BA
#define B129 B15 BD8 B32 B57 B10 B16 BA B1B BD5 BA
#define B12A B4 BE5 B10 BA B1A B2 B76 B4 B78 B14
#define B12B B8 BD B9 B4 B10 B78 BA B70 B7 B10
#define B12C B78 BA B71 B7 B10 B78 BA B50 B7 B10
#define B12D B78 BA B86 B7 B10 B78 BA B48 B7 B10
#define B12E B78 BA B89 B7 B10 B78 BA B99 B7 B10
#define B12F B78 BA B52 B7 B10 B78 BA B7F B7 B10
#define B130 B78 BA B58 B7 B10 B78 BA B4D B7 B10
#define B131 B78 BA B85 B7 B10 B78 BA B9C B7 B10
#define B132 B78 BA B8E B7 B10 B78 BA B93 B7 B10
#define B133 B78 BA B94 B7 B10 B78 BA B96 B7 B10
#define B134 B78 BA B8D B7 B10 B78 BA B4E B7 B10
#define B135 B78 BA B54 B7 B10 B78 BA B91 B7 B10
#define B136 B78 BA B98 B7 B10 B78 BA B7F B7 B10
#define B137 B78 BA B7F B7 B10 B78 BA B71 B7 B10
#define B138 B78 BA B70 B7 B10 B78 BA B44 B2 B1A
#define B139 B78 B11 B8 BD B9 B4 B10 B78 BA B70
#define B13A B7 B10 B78 BA B71 B7 B10 B78 BA B9A
#define B13B B7 B10 B78 BA B8B B7 B10 B78 BA B7F
#define B13C B7 B10 B78 BA B8A B7 B10 B78 BA B4C
#define B13D B7 B10 B78 BA B97 B7 B10 B78 BA B7F
#define B13E B7 B10 B78 BA B87 B7 B10 B78 BA B99
#define B13F B7 B10 B78 BA B4D B7 B10 B78 BA B92
#define B140 B7 B10 B78 BA B9D B7 B10 B78 BA B9B
#define B141 B7 B10 B78 BA B89 B7 B10 B78 BA B49
#define B142 B7 B10 B78 BA B53 B7 B10 B78 BA B95
#define B143 B7 B10 B78 BA B4F B7 B10 B78 BA B8F
#define B144 B7 B10 B78 BA B88 B7 B10 B78 BA B90
#define B145 B7 B10 B78 BA B8C B7 B10 B78 BA B71
#define B146 B7 B10 B78 BA B70 B7 B10 B78 BA B44
#define B147 B2 B1A B78 BB B8 BD B9 B4 B10 B78
#define B157 BA B6F B7 B10 B78 BA B6F B7 B10 B78
#define B149 BA B71 B7 B10 B78 BA B61 B7 B10 B78
#define B14A BA B5B B7 B10 B78 BA B5B B7 B10 B78
#define B14B BA B5E B7 B10 B78 BA B5C B7 B10 B78
#define B14C BA B69 B7 B10 B78 BA B6A B7 B10 B78
#define B14D BA B6A B7 B10 B78 BA B66 B7 B10 B78
#define B14E BA B5F B7 B10 B78 BA B64 B7 B10 B78
#define B14F BA B63 B7 B10 B78 BA B62 B7 B10 B78
#define B150 BA B5F B7 B10 B78 BA B5A B7 B10 B78
#define B151 BA B6E B7 B10 B78 BA B5B B7 B10 B78
#define B152 BA B68 B7 B10 B78 BA B5F B7 B10 B78
#define B153 BA B67 B7 B10 B78 BA B68 B7 B10 B78
#define B154 BA B5F B7 B10 B78 BA B6E B7 B10 B78
#define B155 BA B66 B7 B10 B78 BA B5F B7 B10 B78
#define B156 BA B60 B7 B10 B78 BA B71 B7 B10 B78
#define B157 BA B6F B7 B10 B78 BA B6F B7 B10 B78
#define B158 BA B3E B7 B10 B78 BA B44 B2 B1A B78
#define B159 BF B8 BD B9 B74 B1A B78 B5 B8 BD
#define B15A B9 B73 B1A BAE B10 B20 B14 BA B1A BAE
#define B15B B10 B5 BA B1A BAE B10 B20 B11 BA B1A
#define B15C BAE B10 B5 BA B1A BAE B10 B20 BB BA
#define B15D B1A B2 BAB B27 B2 
#define B15E B100 B101 B102 B103 B104 B105 B106 B107 B108 B109
#define B15F B10A B10B B10C B10D B10E B10F B110 B111 B112 B113
#define B160 B114 B115 B116 B117 B118 B119 B11A B11B B11C B11D
#define B161 B11E B11F B120 B121 B122 B123 B124 B125 B126 B127
#define B162 B128 B129 B12A B12B B12C B12D B12E B12F B130 B131
#define B163 B132 B133 B134 B135 B136 B137 B138 B139 B13A B13B
#define B164 B13C B13D B13E B13F B140 B141 B142 B143 B144 B145
#define B165 B146 B147 B157 B149 B14A B14B B14C B14D B14E B14F
#define B166 B150 B151 B152 B153 B154 B155 B156 B157 B158 B159
#define B167 B15A B15B B15C B15D 
#define B168 B15E B15F B160 B161 B162 B163 B164 B165 B166 B167
#define B169(__FOX__) __FOX__
B169(B168)
